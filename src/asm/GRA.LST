1000 ;õ1010 ; MODUL: «“¡õ1020 ;õ1030 ;õ1040 COLORSTABB .BYTE 0,10,0,0,0õ1050 ;õ1060 ANIMPROC INC ANIMPAUZAõ1070     LDA ANIMPAUZAõ1080     CMP #6õ1090     BCC ANIMPROC1õ1100     LDA #0õ1110     STA ANIMPAUZAõ1120     LDA ANIMFAZAõ1130     ASL Aõ1140     ASL Aõ1150     ASL Aõ1160     CLC õ1170     ADC # <ANIMBUFõ1180     STA IZNõ1190     LDA # >ANIMBUFõ1200     ADC #0õ1210     STA IZN+1õ1220     LDA #9õ1230     STA IZN+2õ1240     LDX #0õ1250 ANIMPROC2 LDY #0õ1260 ANIMPROC3 LDA (IZN),Yõ1270     STA MAPAPIC+82*8,Xõ1280     INY õ1290     INX õ1300     CPY #8õ1310     BNE ANIMPROC3õ1320     CLC õ1330     LDA IZNõ1340     ADC #32õ1350     STA IZNõ1360     BCC ANIMPROC4õ1370     INC IZN+1õ1380 ANIMPROC4 DEC IZN+2õ1390     BNE ANIMPROC2õ1400     INC ANIMFAZAõ1410     LDA ANIMFAZAõ1420     AND #3õ1430     STA ANIMFAZAõ1440 ANIMPROC1 RTS õ1450 ;õ1460 VBLTIMERDOWN LDA VBLTIMERõ1470     BEQ VBLTIMERDOWN1õ1480     DEC VBLTIMERõ1490 VBLTIMERDOWN1 RTS õ1500 ;õ1510 SETCOLA LDY #4õ1520 SETCOLA1 LDA COLORSBUFA,Yõ1530     STA $D016,Yõ1540     DEY õ1550     BPL SETCOLA1õ1560     LDA CHARGENVECTõ1570     STA $D409õ1580     RTS õ1590 ;õ1600 SETCOLB LDY #4õ1610     LDA # >CHARGENõ1620     STA $D409õ1630 SETCOLB1 LDA COLORSBUFB,Yõ1640     STA $D016,Yõ1650     DEY õ1660     BPL SETCOLB1õ1670     RTS õ1680 ;õ1690 VBLOBS JSR VBLTIMERDOWNõ1700     JSR RTIMEROBSõ1710     JSR USERVBLGOõ1720     JMP MUSICPLAYõ1730 ;õ1740 USERVBLGO JMP (USERVBLVECT)õ1750 ;õ1760 DLIOBS LDA $D40Bõ1770     CMP #78õ1780     BCS DLIOBS1õ1790     JMP SETCOLAõ1800 DLIOBS1 JMP SETCOLBõ1810 ;õ1820 NMIOBS PHA õ1830     TYA õ1840     PHA õ1850     TXA õ1860     PHA õ1870     LDA $D40Fõ1880     STA $D40Fõ1890     ASL Aõ1900     BCC NMIOBS1õ1910     JSR DLIOBSõ1920     JMP NMIOBS2õ1930 NMIOBS1 ASL Aõ1940     BCC NMIOBS2õ1950     JSR VBLOBSõ1960 NMIOBS2 PLA õ1970     TAX õ1980     PLA õ1990     TAY õ2000     PLA õ2010     RTI õ2020 ;õ2030 RTIMEROBS INC RTIMERõ2040     LDA RTIMERõ2050     CMP #50õ2060     BNE RTIMEROBS1õ2070     LDA #0õ2080     STA RTIMERõ2090     INC RTIMER+1õ2100     LDA RTIMER+1õ2110     CMP #60õ2120     BNE RTIMEROBS1õ2130     LDA #0õ2140     STA RTIMER+1õ2150     INC RTIMER+2õ2160     LDA RTIMER+2õ2170     CMP #60õ2180     BNE RTIMEROBS1õ2190     LDA #0õ2200     STA RTIMER+2õ2210     INC RTIMER+3õ2220     LDA RTIMER+3õ2230     CMP #24õ2240     BNE RTIMEROBS1õ2250     LDA #0õ2260     STA RTIMER+3õ2270 RTIMEROBS1 LDY # <TIMELINE+2õ2280     LDX # >TIMELINE+2õ2290 PRRTIMER LDA VZNõ2300     PHA õ2310     LDA VZN+1õ2320     PHA õ2330     STY VZNõ2340     STX VZN+1õ2350     LDY #0õ2360     LDA RTIMER+3õ2370     JSR RTIMERPROCõ2380     JSR RTIMERPROCBõ2390     LDA RTIMER+2õ2400     JSR RTIMERPROCõ2410     JSR RTIMERPROCBõ2420     LDA RTIMER+1õ2430     JSR RTIMERPROCõ2440     PLA õ2450     STA VZN+1õ2460     PLA õ2470     STA VZNõ2480     RTS õ2490 ;õ2500 RTIMERPROC LDX #16õ2510 RTIMERPROC1 CMP #10õ2520     BCC RTIMERPROC2õ2530     SBC #10õ2540     INX õ2550     BNE RTIMERPROC1õ2560 RTIMERPROC2 ORA #16õ2570     PHA õ2580     TXA õ2590     STA (VZN),Yõ2600     INY õ2610     PLA õ2620     STA (VZN),Yõ2630     INY õ2640     RTS õ2650 ;õ2660 RTIMERPROCB LDA #$1Aõ2670     STA (VZN),Yõ2680     INY õ2690     RTS õ2700 ;õ2710 CLRSTAT LDY #79õ2720     LDA #0õ2730 CLRSTAT1 STA TIMELINE,Yõ2740     DEY õ2750     BPL CLRSTAT1õ2760     LDY #[ENDSTAT-RTIMER-1]õ2770 CLRSTAT2 STA RTIMER,Yõ2780     DEY õ2790     BPL CLRSTAT2õ2800     LDA #20õ2810     STA BUYSOLDõ2820     STA BUYSOLD+2õ2830     LDA #1õ2840     STA NMCYõ2850     STA NMCY+1õ2860     RTS õ2870 ;õ2880 USERVBLPROC .WORD ANIMPROCõ2890     .WORD NULLPROCõ2900     .WORD NULLPROCõ2910     .WORD NULLPROCõ2920     .WORD NULLPROCõ2930     .WORD NULLPROCõ2940     .WORD NULLPROCõ2950     .WORD NULLPROCõ2960 ;õ2970 NULLPROC RTS õ2980 ;õ2990 SETSCR PHA õ3000     JSR SCREENOFFõ3010     PLA õ3020 SETSCRPROC ASL Aõ3030     TAY õ3040     LDA USERVBLPROC,Yõ3050     STA USERVBLVECTõ3060     LDA USERVBLPROC+1,Yõ3070     STA USERVBLVECT+1õ3080     TYA õ3090     ASL Aõ3100     ASL Aõ3110     CLC õ3120     ADC # >MAPAPICõ3130     STA CHARGENVECTõ3140     CLC õ3150     ADC #4õ3160     STA DLPEZN+1õ3170     ADC #3õ3180     STA VZN+1õ3190     LDX #251õ3200     STX VZNõ3210     LDY #4õ3220 SETSCR1 LDA (VZN),Yõ3230     STA COLORSBUFA,Yõ3240     LDA COLORSTABB,Yõ3250     STA COLORSBUFB,Yõ3260     DEY õ3270     BPL SETSCR1õ3280     RTS õ3290 ;õ3300 PREPGRADL LDA # <DLõ3310     LDY # >DLõ3320     STA $D402õ3330     STY $D403õ3340     LDA # <NMIOBSõ3350     LDY # >NMIOBSõ3360     STA $FFFAõ3370     STY $FFFBõ3380     LDY #62õ3390     LDX #192õ3400 PREPGRADL1 LDA $D40Bõ3410     BNE PREPGRADL1õ3420     STY $D400õ3430     STX $D40Eõ3440     JMP SETCOLBõ3450 ;õ3460 PREPGRA LDA # >PMBASEõ3470     LDY #3õ3480     LDX #1õ3490     STA 54279õ3500     STY 53277õ3510     STX 53275õ3520     LDA #0õ3530     STA ANIMFAZAõ3540     STA VBLTIMERõ3550     LDA #5õ3560     STA ANIMPAUZAõ3570     LDA #2õ3580     JSR SETSCRPROCõ3590     JSR SETCOLAõ3600     JMP PREPGRADLõ3610 ;õ3620 REFRSCR LDA #1õ3630     JSR WAITõ3640     LDA #12õ3650     STA $D012õ3660     LDA #24õ3670     STA VZNõ3680     LDX #0õ3690 REFRSCR1 CPX ARMPOSõ3700     BEQ REFRSCR11õ3710     CPX ARMPOS+1õ3720     BEQ REFRSCR11õ3730     CPX ARMPOS+2õ3740     BEQ REFRSCR11õ3750     CPX ARMPOS+3õ3760     BEQ REFRSCR11õ3770     TXA õ3780     ASL Aõ3790     TAY õ3800     LDA SHIELDTAB,Yõ3810     CLC õ3820     ADC # <MAPAPIC+1024õ3830     STA VZN+1õ3840     LDA SHIELDTAB+1,Yõ3850     ADC # >MAPAPIC+1024õ3860     STA VZN+2õ3870     LDY #0õ3880     LDA #128õ3890     STA (VZN+1),Yõ3900 REFRSCR11 INX õ3910     DEC VZNõ3920     BNE REFRSCR1õ3930     LDX #0õ3940 REFRSCR2 LDA ARMPOS,Xõ3950     BMI REFRSCR7õ3960     ASL Aõ3970     TAY õ3980     CLC õ3990     LDA SHIELDTAB,Yõ4000     ADC # <MAPAPIC+1024õ4010     STA VZNõ4020     LDA SHIELDTAB+1,Yõ4030     ADC # >MAPAPIC+1024õ4040     STA VZN+1õ4050     LDY #0õ4060     LDA #208õ4070     STA (VZN),Yõ4080 REFRSCR7 INX õ4090     CPX #4õ4100     BNE REFRSCR2õ4110     LDX #0õ4120 REFRSCR3 TXA õ4130     ASL Aõ4140     TAY õ4150     CLC õ4160     LDA FLAGTAB,Yõ4170     ADC # <MAPAPIC+1024õ4180     STA VZNõ4190     LDA FLAGTAB+1,Yõ4200     ADC # >MAPAPIC+1024õ4210     STA VZN+1õ4220     LDY #209õ4230     LDA KSTAB,Xõ4240     BMI REFRSCR4õ4250     CLC õ4260     ADC #210õ4270     TAY õ4280 REFRSCR4 TYA õ4290     LDY #0õ4300     STA (VZN),Yõ4310     INX õ4320     CPX #24õ4330     BNE REFRSCR3õ4340     SEC õ4350     JSR PRINTNULLõ4360     LDA # <DATADATõ4370     LDY # >DATADATõ4380     LDX GRACZõ4390     CPX HUMANPLõ4400     BEQ REFRSCR5õ4410     CPX HUMANPL+1õ4420     BNE REFRSCR8õ4430 REFRSCR5 LDA # <ZLOTODATADATõ4440     LDY # >ZLOTODATADATõ4450     LDX #0õ4460 REFRSCR8 PHP õ4470     CLC õ4480     JSR PRINTõ4490     LDA #0õ4500     CLC õ4510     PHP õ4520     LDA ROKõ4530     LDY ROK+1õ4540     LDX #23õ4550     PLP õ4560     JSR CONVDECõ4570     LDA MIESIACõ4580     ASL Aõ4590     ASL Aõ4600     ASL Aõ4610     ASL Aõ4620     TAY õ4630     LDX #0õ4640 REFRSCR6 LDA MIESDAT,Yõ4650     STA INFOLINE+29,Xõ4660     INY õ4670     INX õ4680     CPX #11õ4690     BNE REFRSCR6õ4700     LDA GRACZõ4710     PLP õ4720     BNE REFRSCR9õ4730     LDY #0õ4740     JSR PRINTPLNAMEõ4750     LDA GRACZõ4760     ASL Aõ4770     TAX õ4780     LDA #0õ4790     CLC õ4800     PHP õ4810     LDA KASAZN+1,Xõ4820     TAY õ4830     LDA KASAZN,Xõ4840     LDX #13õ4850     PLP õ4860     JSR CONVDECõ4870     JMP REFRSCR10õ4880 REFRSCR9 LDY #12õ4890     JSR PRINTPLNAMEõ4900 REFRSCR10 RTS õ4910 ;õ4920 PLOTMAN LDX GRACZõ4930     LDA KSZN,Xõ4940     BEQ PLOTMAN2õ4950     LDA #1õ4960     JSR WAITõ4970     CLC õ4980     LDA GRACZõ4990     ADC # >MANBUFõ5000     STA ZN+1õ5010     LDY #0õ5020     STY ZNõ5030 PLOTMAN1 LDA (ZN),Yõ5040     STA MAPAPIC+98*8,Yõ5050     INY õ5060     CPY #240õ5070     BNE PLOTMAN1õ5080 PLOTMAN2 RTS õ5090 ;õ5100 DATADAT .SBYTE "   RUCH MA:        ROK:     ,           "õ5110 ZLOTODATADAT .SBYTE "     : Z^OTO:      ROK:     ,           "õ5120 ;õ5130 MIESDAT .SBYTE "STYCZE_         "õ5140     .SBYTE "LUTY            "õ5150     .SBYTE "MARZEC          "õ5160     .SBYTE "KWIECIE_        "õ5170     .SBYTE "MAJ             "õ5180     .SBYTE "CZERWIEC        "õ5190     .SBYTE "LIPIEC          "õ5200     .SBYTE "SIERPIE_        "õ5210     .SBYTE "WRZESIE_        "õ5220     .SBYTE "PADZIERNIK     "õ5230     .SBYTE "LISTOPAD        "õ5240     .SBYTE "GRUDZIE_        "õ5250 ;õ5260 TIMEUPPROC LDA HUMANPL,Xõ5270     TAY õ5280     CPY #255õ5290     BEQ TIMEUPPROC1õ5300     LDA KSZN,Yõ5310     BEQ TIMEUPPROC1õ5320     INC NMCY,Xõ5330 TIMEUPPROC1 RTS õ5340 ;õ5350 TIMEUP LDX #0õ5360     JSR TIMEUPPROCõ5370     INX õ5380     JSR TIMEUPPROCõ5390     INC MIESIACõ5400     LDA MIESIACõ5410     CMP #12õ5420     BNE TIMEUP1õ5430     LDA #0õ5440     STA MIESIACõ5450     INC ROKõ5460     BNE TIMEUP1õ5470     INC ROK+1õ5480 TIMEUP1 RTS õ5490 ;õ5500 CHKGRTRUP LDX GRACZõ5510     LDA KSZN,Xõ5520     BNE CHKGRTRUP1õ5530     LDA #255õ5540     STA ARMPOS,Xõ5550     TXA õ5560     ASL Aõ5570     TAX õ5580     LDA #0õ5590     STA DOCHZN,Xõ5600     STA DOCHZN+1,Xõ5610 CHKGRTRUP1 RTS õ5620 ;õ5630 SCREENOFF LDA #1õ5640     JSR WAITõ5650     LDX #9õ5660     LDY #0õ5670 SCREENOFF2 LDA COLORSBUFA,Xõ5680     AND #15õ5690     BEQ SCREENOFF1õ5700     DEC COLORSBUFA,Xõ5710     INY õ5720 SCREENOFF1 DEX õ5730     BPL SCREENOFF2õ5740     TYA õ5750     BNE SCREENOFFõ5760     LDX #9õ5770     LDA #0õ5780 SCREENOFF3 STA COLORSBUFA,Xõ5790     DEX õ5800     BPL SCREENOFF3õ5810     LDY # <NULLPROCõ5820     LDX # >NULLPROCõ5830 SETVBLPROC LDA #1õ5840     JSR WAITõ5850     STY USERVBLVECTõ5860     STX USERVBLVECT+1õ5870     RTS õ5880 ;õ5890 CHKBUNT LDY #0õ5900     LDX GRACZõ5910     CPX HUMANPLõ5920     BEQ CHKBUNT3õ5930     CPX HUMANPL+1õ5940     BNE CHKBUNT1õ5950     INY õ5960 CHKBUNT3 LDA NMCY,Yõ5970     CMP #96     ; 6 LATõ5980     BEQ CHKBUNT2õ5990     CMP #60     ; 5 LATõ6000     BCC CHKBUNT1õ6010     LDA $D20Aõ6020     AND #3õ6030     BNE CHKBUNT1õ6040 CHKBUNT2 LDA ARMPOS,Xõ6050     TAY õ6060     TXA õ6070     JSR CRBUFõ6080     JSR WOJKUPAõ6090     LDX GRACZõ6100     LDA #0õ6110     STA KSZN,Xõ6120     LDY #23õ6130 CHKBUNT4 LDA KSTAB,Yõ6140     CMP GRACZõ6150     BNE CHKBUNT5õ6160     LDA #255õ6170     STA KSTAB,Yõ6180 CHKBUNT5 DEY õ6190     BPL CHKBUNT4õ6200 CHKBUNT1 RTS õ6210 ;õ6220 CHKPLENDPROC LDA HUMANPL,Yõ6230     TAX õ6240     CPX #255õ6250     BEQ CHKPLENDPROC1õ6260     LDA KSZN,Xõ6270     BNE CHKPLENDPROC1õ6280     TYA õ6290     PHA õ6300     JSR KONIECTRUPõ6310     JSR PREPGRADLõ6320     JSR REFRSCRõ6330     LDA #50õ6340     JSR WAITõ6350     PLA õ6360     TAY õ6370     LDA #255õ6380     STA HUMANPL,Yõ6390 CHKPLENDPROC1 RTS õ6400 ;õ6410 CHKPLEND LDY #0õ6420     JSR CHKPLENDPROCõ6430     INY õ6440     JSR CHKPLENDPROCõ6450     LDA HUMANPLõ6460     AND HUMANPL+1õ6470     CMP #255õ6480     RTS õ6490 ;õ6500 CHKPLWINPROC LDA HUMANPL,Yõ6510     TAX õ6520     CPX #255õ6530     BEQ CHKPLWINPROC1õ6540     LDA KSZN,Xõ6550     CMP #24õ6560     BNE CHKPLWINPROC1õ6570     SEC õ6580     BCS CHKPLWINPROC2õ6590 CHKPLWINPROC1 CLC õ6600 CHKPLWINPROC2 RTS õ6610 ;õ6620 CHKPLWIN LDY #0õ6630     JSR CHKPLWINPROCõ6640     BCS CHKPLWIN1õ6650     INY õ6660     JSR CHKPLWINPROCõ6670 CHKPLWIN1 RTS õ6680 ;õ6690 GRA JSR INITGRAõ6700     LDA #0õ6710     STA QUITZNõ6720     STA GRACZõ6730     JSR REFRSCRõ6740 GRA1 LDA #0õ6750     STA GRACZõ6760     JSR SOJDOWNõ6770 GRA2 JSR CHKBUNTõ6780     JSR CHKGRTRUPõ6790     BEQ GRA3õ6800     JSR REFRSCRõ6810     JSR PLOTMANõ6820     JSR RUCHGRõ6830     JSR REFRSCRõ6840     LDA #50õ6850     JSR WAITõ6860 GRA3 JSR CHKPLENDõ6870     BEQ GRA4õ6880     JSR CHKPLWINõ6890     BCS GRA5õ6900     LDA QUITZNõ6910     BNE GRA6õ6920     INC GRACZõ6930     LDA GRACZõ6940     CMP #4õ6950     BNE GRA2õ6960     JSR TIMEUPõ6970     JMP GRA1õ6980 GRA4 JMP SCREENOFFõ6990 GRA5 LDA #50õ7000     JSR WAITõ7010     JSR SCREENOFFõ7020     JMP KONIECWINõ7030 GRA6 LDA #50õ7040     JSR WAITõ7050     JSR SCREENOFFõ7060     JMP KONIECBREAKõ7070 ;õ7080 MUSICON PHA õ7090     LDA #$70õ7100     LDX # <MUZYKADATõ7110     LDY # >MUZYKADATõ7120     JSR MUZYKAPR+3õ7130     PLA õ7140     TAX õ7150     LDA #$00õ7160     JMP MUZYKAPR+3õ7170 ;õ7180 MUSICOFF LDA #$40õ7190     JMP MUZYKAPR+3õ7200 ;õ7210 MUSICPLAY LDA MUSICZNõ7220     BMI MUSICPLAY5õ7230     LDA $D01Fõ7240     AND #$07õ7250     CMP #$06õ7260     BNE MUSICPLAY1õ7270     LDA #$00õ7280     STA MUSICZNõ7290     BEQ MUSICPLAY2õ7300 MUSICPLAY1 CMP #$05õ7310     BNE MUSICPLAY2õ7320     LDA #$01õ7330     STA MUSICZNõ7340 MUSICPLAY2 LDA MUSICZNõ7350     BNE MUSICPLAY3õ7360     JMP MUZYKAPR+6õ7370 MUSICPLAY3 LDA #0õ7380     LDY #8õ7390 MUSICPLAY4 STA $D200,Yõ7400     DEY õ7410     BPL MUSICPLAY4õ7420 MUSICPLAY5 RTS õ7430 ;õ7440 SELMANTXT1 .SBYTE "       GRACZ 1 - WYBIERZ POSTA\:        "õ7450 SELMANTXT2 .SBYTE "           WPISZ SWOJE IMI]:            "õ7460 SELMANTXT3 .SBYTE "      TA POSTA\ JEST JU WYBRANA!       "õ7470 ;õ7480 SELMAN LDY #31õ7490 SELMAN1 LDA NAMPLDAT,Yõ7500     STA NAMPLTAB,Yõ7510     DEY õ7520     BPL SELMAN1õ7530     STY HUMANPL+1õ7540     STY IMMZNõ7550     LDA #12õ7560     STA $D012õ7570     LDA #0õ7580     JSR SELMANPROCõ7590     STA HUMANPLõ7600     JSR GETNAMEõ7610     LDA NOPCJAõ7620     BEQ SELMAN2õ7630 SELMAN3 LDA #1õ7640     JSR SELMANPROCõ7650     CMP HUMANPLõ7660     BNE SELMAN4õ7670     LDA # <SELMANTXT3õ7680     LDY # >SELMANTXT3õ7690     CLC õ7700     JSR PRINTõ7710     SEC õ7720     JSR PRINTNULLõ7730     LDA NOPCJAõ7740     LSR Aõ7750     TAY õ7760     JSR WAITFIREõ7770     JMP SELMAN3õ7780 SELMAN4 STA HUMANPL+1õ7790     JSR GETNAMEõ7800 SELMAN2 LDA #0õ7810     STA $D000õ7820     RTS õ7830 ;õ7840 SELMANPROC STA ZNõ7850     LDA # <SELMANTXT1õ7860     LDY # >SELMANTXT1õ7870     CLC õ7880     JSR PRINTõ7890     CLC õ7900     LDA ZNõ7910     ADC #17õ7920     STA INFOLINE+13õ7930     SEC õ7940     JSR PRINTNULLõ7950     LDA #0õ7960     LDY #3õ7970     STA XCELõ7980     STA XCELMINõ7990     STY XCELMAXõ8000     TAY õ8010 SELMANPROC1 STA PMBASE+$0400,Yõ8020     INY õ8030     BNE SELMANPROC1õ8040     LDX #0õ8050 SELMANPROC2 LDA DKURDAT,Xõ8060     STA PMBASE+$0400+80,Yõ8070     INY õ8080     INY õ8090     INX õ8100     CPX #8õ8110     BNE SELMANPROC2õ8120 SELMANPROC3 LDY #0õ8130     LDA NOPCJAõ8140     CMP #2õ8150     BNE SELMANPROC5õ8160     LDY ZNõ8170 SELMANPROC5 JSR GETJOYõ8180     STA POMõ8190     JSR CHKPOZõ8200     LDY XCELõ8210     LDA XKURSOJOPTTAB,Yõ8220     STA $D000õ8230     TYA õ8240     LDY #57õ8250     JSR PRINTPLNAMEõ8260     LDA #4õ8270     JSR WAITõ8280     LDY #0õ8290     LDA NOPCJAõ8300     CMP #2õ8310     BNE SELMANPROC4õ8320     LDY ZNõ8330 SELMANPROC4 JSR GETFIREõ8340     BNE SELMANPROC3õ8350     JSR WAITFIREBõ8360     LDA XCELõ8370     RTS õ8380 ;õ8390 GETKEY LDA #$00õ8400     LDY #$40õ8410     STA $D20Eõ8420     STY $D20Eõ8430 GETKEY1 LDA $D20Eõ8440     AND #$40õ8450     BNE GETKEY1õ8460     LDA $D209õ8470     LDY #36õ8480 GETKEY2 CMP KEYTAB1,Yõ8490     BEQ GETKEY3õ8500     DEY õ8510     BPL GETKEY2õ8520     BMI GETKEYõ8530 GETKEY3 LDA KEYTAB2,Yõ8540     RTS õ8550 ;õ8560 KEYTAB1 .BYTE $3F,$15,$12,$3A,$2A,$38,$3D,$39,$0D,$01,$05,$00,$25,$23,$08,$0A,$2F,$28,$3E,$2Dõ8570     .BYTE $0B,$10,$2E,$16,$2B,$17õ8580     .BYTE $BF,$92,$AA,$80,$A3,$88,$BE,$97,$96,$34,$0Cõ8590 ;õ8600 KEYTAB2 .SBYTE "ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_ ˛ˇ"õ8610 ;õ8620 GETNAME PHA õ8630 GETNAME4 LDA # <SELMANTXT2õ8640     LDY # >SELMANTXT2õ8650     CLC õ8660     JSR PRINTõ8670     SEC õ8680     JSR PRINTNULLõ8690     LDA #0õ8700     STA VZNõ8710     LDA #$80õ8720     STA MENULINE+17õ8730 GETNAME1 JSR GETKEYõ8740     CMP #254õ8750     BEQ GETNAME4õ8760     CMP #255õ8770     BEQ GETNAME2õ8780     LDY VZNõ8790     STA MENULINE+17,Yõ8800     LDA #$80õ8810     STA MENULINE+18,Yõ8820     LDA VZNõ8830     CMP #$04õ8840     BEQ GETNAME1õ8850     INC VZNõ8860     BNE GETNAME1õ8870 GETNAME2 PLA õ8880     ASL Aõ8890     ASL Aõ8900     ASL Aõ8910     TAY õ8920     LDX #0õ8930 GETNAME3 LDA MENULINE+17,Xõ8940     AND #127õ8950     STA NAMPLTAB,Yõ8960     INX õ8970     INY õ8980     CPX #5õ8990     BNE GETNAME3õ9000     JMP CHKIMMõ9010 ;õ9020 PASSWORD .SBYTE "SECOH"õ9030 ;õ9040 CHKIMM LDA IMMZNõ9050     BEQ CHKIMM3õ9060     LDY #4õ9070     LDX #0õ9080 CHKIMM1 LDA MENULINE+17,Yõ9090     AND #127õ9100     CMP PASSWORD,Yõ9110     BEQ CHKIMM2õ9120     INX õ9130 CHKIMM2 DEY õ9140     BPL CHKIMM1õ9150     TXA õ9160     BNE CHKIMM3õ9170     STA IMMZNõ9180 CHKIMM3 RTS õ9190 ;õ9200 INITGRA JSR PREPGRAõ9210     JSR CLRSTATõ9220     JSR SELMANõ9230     LDA # <KSTABõ9240     LDX # >KSTABõ9250     LDY #0õ9260     STA ZNõ9270     STX ZN+1õ9280     TYA õ9290 INITGRA1 STA (ZN),Yõ9300     INC ZNõ9310     BNE INITGRA2õ9320     INC ZN+1õ9330 INITGRA2 LDX ZNõ9340     CPX # <BUFFERõ9350     BNE INITGRA1õ9360     LDX ZN+1õ9370     CPX # >BUFFERõ9380     BNE INITGRA2õ9390     LDY #6õ9400 INITGRA3 LDA #20õ9410     STA WOJZN,Yõ9420     STA KASAZN,Yõ9430     LDA #0õ9440     STA WOJZN+1,Yõ9450     STA KASAZN+1,Yõ9460     TYA õ9470     LSR Aõ9480     CMP HUMANPLõ9490     BEQ INITGRA9õ9500     CMP HUMANPL+1õ9510     BNE INITGRA7õ9520 INITGRA9 LDA IMMZNõ9530     BNE INITGRA7õ9540     LDA #255õ9550     STA KASAZN,Yõ9560     STA KASAZN+1,Yõ9570     STA WOJZN,Yõ9580     STA WOJZN+1,Yõ9590     STA BUYSOLDõ9600     STA BUYSOLD+1õ9610     STA BUYSOLD+2õ9620     STA BUYSOLD+3õ9630 INITGRA7 DEY õ9640     DEY õ9650     BPL INITGRA3õ9660     LDX #23õ9670     LDA #255õ9680 INITGRA4 STA KSTAB,Xõ9690     DEX õ9700     BPL INITGRA4õ9710     LDX #3õ9720 INITGRA5 CPX HUMANPLõ9730     BEQ INITGRA8õ9740     CPX HUMANPL+1õ9750     BEQ INITGRA8õ9760     LDA NOPCJAõ9770     BEQ INITGRA8õ9780     JSR FIND3KSõ9790     JMP INITGRA6õ9800 INITGRA8 JSR FIND1KSõ9810 INITGRA6 DEX õ9820     BPL INITGRA5õ9830     LDA #0õ9840     LDY #237õ9850     LDX #56õ9860     STA MIESIACõ9870     STY ROKõ9880     STX ROK+1õ9890     LDA #0õ9900     JMP SETSCRõ9910 ;õ9920 FINDKSPROC LDA $D20Aõ9930     AND #31õ9940     CMP #24õ9950     BCS FINDKSPROCõ9960     TAY õ9970     LDA KSTAB,Yõ9980     BPL FINDKSPROCõ9990     TYA õ010000   RTS õ010010 ;õ010020 FIND1KS JSR FINDKSPROCõ010030   STA ARMPOS,Xõ010040   TXA õ010050   STA KSTAB,Yõ010060   LDA #1õ010070   STA KSZN,Xõ010080   RTS õ010090 ;õ010100 FIND3KS STX VZNõ010110 FIND3KS1 LDX VZNõ010120   JSR FINDKSPROCõ010130   STA VZN+1õ010140   ASL Aõ010150   ASL Aõ010160   ASL Aõ010170   TAY õ010180   LDA NEARTAB,Yõ010190   BMI FIND3KS1õ010200   TAX õ010210   LDA KSTAB,Xõ010220   BPL FIND3KS1õ010230   STX VZN+2õ010240   INY õ010250   LDA NEARTAB,Yõ010260   BMI FIND3KS1õ010270   TAX õ010280   LDA KSTAB,Xõ010290   BPL FIND3KS1õ010300   STX VZN+3õ010310   LDA VZNõ010320   STA KSTAB,Xõ010330   LDX VZN+2õ010340   STA KSTAB,Xõ010350   LDX VZN+1õ010360   STA KSTAB,Xõ010370   TAX õ010380   LDA #3õ010390   STA KSZN,Xõ010400   LDA VZN+1õ010410   STA ARMPOS,Xõ010420   RTS õ010430 ;õ