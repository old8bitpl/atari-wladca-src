1000 ;›1010 ; MODUL: ÇÒÁ›1020 ;›1030 ;›1040 COLORSTABB .BYTE 0,10,0,0,0›1050 ;›1060 ANIMPROC INC ANIMPAUZA›1070     LDA ANIMPAUZA›1080     CMP #6›1090     BCC ANIMPROC1›1100     LDA #0›1110     STA ANIMPAUZA›1120     LDA ANIMFAZA›1130     ASL A›1140     ASL A›1150     ASL A›1160     CLC ›1170     ADC # <ANIMBUF›1180     STA IZN›1190     LDA # >ANIMBUF›1200     ADC #0›1210     STA IZN+1›1220     LDA #9›1230     STA IZN+2›1240     LDX #0›1250 ANIMPROC2 LDY #0›1260 ANIMPROC3 LDA (IZN),Y›1270     STA MAPAPIC+82*8,X›1280     INY ›1290     INX ›1300     CPY #8›1310     BNE ANIMPROC3›1320     CLC ›1330     LDA IZN›1340     ADC #32›1350     STA IZN›1360     BCC ANIMPROC4›1370     INC IZN+1›1380 ANIMPROC4 DEC IZN+2›1390     BNE ANIMPROC2›1400     INC ANIMFAZA›1410     LDA ANIMFAZA›1420     AND #3›1430     STA ANIMFAZA›1440 ANIMPROC1 RTS ›1450 ;›1460 VBLTIMERDOWN LDA VBLTIMER›1470     BEQ VBLTIMERDOWN1›1480     DEC VBLTIMER›1490 VBLTIMERDOWN1 RTS ›1500 ;›1510 SETCOLA LDY #4›1520 SETCOLA1 LDA COLORSBUFA,Y›1530     STA $D016,Y›1540     DEY ›1550     BPL SETCOLA1›1560     LDA CHARGENVECT›1570     STA $D409›1580     RTS ›1590 ;›1600 SETCOLB LDY #4›1610     LDA # >CHARGEN›1620     STA $D409›1630 SETCOLB1 LDA COLORSBUFB,Y›1640     STA $D016,Y›1650     DEY ›1660     BPL SETCOLB1›1670     RTS ›1680 ;›1690 VBLOBS JSR VBLTIMERDOWN›1700     JSR RTIMEROBS›1710     JSR USERVBLGO›1720     JMP MUSICPLAY›1730 ;›1740 USERVBLGO JMP (USERVBLVECT)›1750 ;›1760 DLIOBS LDA $D40B›1770     CMP #78›1780     BCS DLIOBS1›1790     JMP SETCOLA›1800 DLIOBS1 JMP SETCOLB›1810 ;›1820 NMIOBS PHA ›1830     TYA ›1840     PHA ›1850     TXA ›1860     PHA ›1870     LDA $D40F›1880     STA $D40F›1890     ASL A›1900     BCC NMIOBS1›1910     JSR DLIOBS›1920     JMP NMIOBS2›1930 NMIOBS1 ASL A›1940     BCC NMIOBS2›1950     JSR VBLOBS›1960 NMIOBS2 PLA ›1970     TAX ›1980     PLA ›1990     TAY ›2000     PLA ›2010     RTI ›2020 ;›2030 RTIMEROBS INC RTIMER›2040     LDA RTIMER›2050     CMP #50›2060     BNE RTIMEROBS1›2070     LDA #0›2080     STA RTIMER›2090     INC RTIMER+1›2100     LDA RTIMER+1›2110     CMP #60›2120     BNE RTIMEROBS1›2130     LDA #0›2140     STA RTIMER+1›2150     INC RTIMER+2›2160     LDA RTIMER+2›2170     CMP #60›2180     BNE RTIMEROBS1›2190     LDA #0›2200     STA RTIMER+2›2210     INC RTIMER+3›2220     LDA RTIMER+3›2230     CMP #24›2240     BNE RTIMEROBS1›2250     LDA #0›2260     STA RTIMER+3›2270 RTIMEROBS1 LDY # <TIMELINE+2›2280     LDX # >TIMELINE+2›2290 PRRTIMER LDA VZN›2300     PHA ›2310     LDA VZN+1›2320     PHA ›2330     STY VZN›2340     STX VZN+1›2350     LDY #0›2360     LDA RTIMER+3›2370     JSR RTIMERPROC›2380     JSR RTIMERPROCB›2390     LDA RTIMER+2›2400     JSR RTIMERPROC›2410     JSR RTIMERPROCB›2420     LDA RTIMER+1›2430     JSR RTIMERPROC›2440     PLA ›2450     STA VZN+1›2460     PLA ›2470     STA VZN›2480     RTS ›2490 ;›2500 RTIMERPROC LDX #16›2510 RTIMERPROC1 CMP #10›2520     BCC RTIMERPROC2›2530     SBC #10›2540     INX ›2550     BNE RTIMERPROC1›2560 RTIMERPROC2 ORA #16›2570     PHA ›2580     TXA ›2590     STA (VZN),Y›2600     INY ›2610     PLA ›2620     STA (VZN),Y›2630     INY ›2640     RTS ›2650 ;›2660 RTIMERPROCB LDA #$1A›2670     STA (VZN),Y›2680     INY ›2690     RTS ›2700 ;›2710 CLRSTAT LDY #79›2720     LDA #0›2730 CLRSTAT1 STA TIMELINE,Y›2740     DEY ›2750     BPL CLRSTAT1›2760     LDY #[ENDSTAT-RTIMER-1]›2770 CLRSTAT2 STA RTIMER,Y›2780     DEY ›2790     BPL CLRSTAT2›2800     LDA #20›2810     STA BUYSOLD›2820     STA BUYSOLD+2›2830     LDA #1›2840     STA NMCY›2850     STA NMCY+1›2860     RTS ›2870 ;›2880 USERVBLPROC .WORD ANIMPROC›2890     .WORD NULLPROC›2900     .WORD NULLPROC›2910     .WORD NULLPROC›2920     .WORD NULLPROC›2930     .WORD NULLPROC›2940     .WORD NULLPROC›2950     .WORD NULLPROC›2960 ;›2970 NULLPROC RTS ›2980 ;›2990 SETSCR PHA ›3000     JSR SCREENOFF›3010     PLA ›3020 SETSCRPROC ASL A›3030     TAY ›3040     LDA USERVBLPROC,Y›3050     STA USERVBLVECT›3060     LDA USERVBLPROC+1,Y›3070     STA USERVBLVECT+1›3080     TYA ›3090     ASL A›3100     ASL A›3110     CLC ›3120     ADC # >MAPAPIC›3130     STA CHARGENVECT›3140     CLC ›3150     ADC #4›3160     STA DLPEZN+1›3170     ADC #3›3180     STA VZN+1›3190     LDX #251›3200     STX VZN›3210     LDY #4›3220 SETSCR1 LDA (VZN),Y›3230     STA COLORSBUFA,Y›3240     LDA COLORSTABB,Y›3250     STA COLORSBUFB,Y›3260     DEY ›3270     BPL SETSCR1›3280     RTS ›3290 ;›3300 PREPGRADL LDA # <DL›3310     LDY # >DL›3320     STA $D402›3330     STY $D403›3340     LDA # <NMIOBS›3350     LDY # >NMIOBS›3360     STA $FFFA›3370     STY $FFFB›3380     LDY #62›3390     LDX #192›3400 PREPGRADL1 LDA $D40B›3410     BNE PREPGRADL1›3420     STY $D400›3430     STX $D40E›3440     JMP SETCOLB›3450 ;›3460 PREPGRA LDA # >PMBASE›3470     LDY #3›3480     LDX #1›3490     STA 54279›3500     STY 53277›3510     STX 53275›3520     LDA #0›3530     STA ANIMFAZA›3540     STA VBLTIMER›3550     LDA #5›3560     STA ANIMPAUZA›3570     LDA #2›3580     JSR SETSCRPROC›3590     JSR SETCOLA›3600     JMP PREPGRADL›3610 ;›3620 REFRSCR LDA #1›3630     JSR WAIT›3640     LDA #12›3650     STA $D012›3660     LDA #24›3670     STA VZN›3680     LDX #0›3690 REFRSCR1 CPX ARMPOS›3700     BEQ REFRSCR11›3710     CPX ARMPOS+1›3720     BEQ REFRSCR11›3730     CPX ARMPOS+2›3740     BEQ REFRSCR11›3750     CPX ARMPOS+3›3760     BEQ REFRSCR11›3770     TXA ›3780     ASL A›3790     TAY ›3800     LDA SHIELDTAB,Y›3810     CLC ›3820     ADC # <MAPAPIC+1024›3830     STA VZN+1›3840     LDA SHIELDTAB+1,Y›3850     ADC # >MAPAPIC+1024›3860     STA VZN+2›3870     LDY #0›3880     LDA #128›3890     STA (VZN+1),Y›3900 REFRSCR11 INX ›3910     DEC VZN›3920     BNE REFRSCR1›3930     LDX #0›3940 REFRSCR2 LDA ARMPOS,X›3950     BMI REFRSCR7›3960     ASL A›3970     TAY ›3980     CLC ›3990     LDA SHIELDTAB,Y›4000     ADC # <MAPAPIC+1024›4010     STA VZN›4020     LDA SHIELDTAB+1,Y›4030     ADC # >MAPAPIC+1024›4040     STA VZN+1›4050     LDY #0›4060     LDA #208›4070     STA (VZN),Y›4080 REFRSCR7 INX ›4090     CPX #4›4100     BNE REFRSCR2›4110     LDX #0›4120 REFRSCR3 TXA ›4130     ASL A›4140     TAY ›4150     CLC ›4160     LDA FLAGTAB,Y›4170     ADC # <MAPAPIC+1024›4180     STA VZN›4190     LDA FLAGTAB+1,Y›4200     ADC # >MAPAPIC+1024›4210     STA VZN+1›4220     LDY #209›4230     LDA KSTAB,X›4240     BMI REFRSCR4›4250     CLC ›4260     ADC #210›4270     TAY ›4280 REFRSCR4 TYA ›4290     LDY #0›4300     STA (VZN),Y›4310     INX ›4320     CPX #24›4330     BNE REFRSCR3›4340     SEC ›4350     JSR PRINTNULL›4360     LDA # <DATADAT›4370     LDY # >DATADAT›4380     LDX GRACZ›4390     CPX HUMANPL›4400     BEQ REFRSCR5›4410     CPX HUMANPL+1›4420     BNE REFRSCR8›4430 REFRSCR5 LDA # <ZLOTODATADAT›4440     LDY # >ZLOTODATADAT›4450     LDX #0›4460 REFRSCR8 PHP ›4470     CLC ›4480     JSR PRINT›4490     LDA #0›4500     CLC ›4510     PHP ›4520     LDA ROK›4530     LDY ROK+1›4540     LDX #23›4550     PLP ›4560     JSR CONVDEC›4570     LDA MIESIAC›4580     ASL A›4590     ASL A›4600     ASL A›4610     ASL A›4620     TAY ›4630     LDX #0›4640 REFRSCR6 LDA MIESDAT,Y›4650     STA INFOLINE+29,X›4660     INY ›4670     INX ›4680     CPX #11›4690     BNE REFRSCR6›4700     LDA GRACZ›4710     PLP ›4720     BNE REFRSCR9›4730     LDY #0›4740     JSR PRINTPLNAME›4750     LDA GRACZ›4760     ASL A›4770     TAX ›4780     LDA #0›4790     CLC ›4800     PHP ›4810     LDA KASAZN+1,X›4820     TAY ›4830     LDA KASAZN,X›4840     LDX #13›4850     PLP ›4860     JSR CONVDEC›4870     JMP REFRSCR10›4880 REFRSCR9 LDY #12›4890     JSR PRINTPLNAME›4900 REFRSCR10 RTS ›4910 ;›4920 PLOTMAN LDX GRACZ›4930     LDA KSZN,X›4940     BEQ PLOTMAN2›4950     LDA #1›4960     JSR WAIT›4970     CLC ›4980     LDA GRACZ›4990     ADC # >MANBUF›5000     STA ZN+1›5010     LDY #0›5020     STY ZN›5030 PLOTMAN1 LDA (ZN),Y›5040     STA MAPAPIC+98*8,Y›5050     INY ›5060     CPY #240›5070     BNE PLOTMAN1›5080 PLOTMAN2 RTS ›5090 ;›5100 DATADAT .SBYTE "   RUCH MA:        ROK:     ,           "›5110 ZLOTODATADAT .SBYTE "     : Z^OTO:      ROK:     ,           "›5120 ;›5130 MIESDAT .SBYTE "STYCZE_         "›5140     .SBYTE "LUTY            "›5150     .SBYTE "MARZEC          "›5160     .SBYTE "KWIECIE_        "›5170     .SBYTE "MAJ             "›5180     .SBYTE "CZERWIEC        "›5190     .SBYTE "LIPIEC          "›5200     .SBYTE "SIERPIE_        "›5210     .SBYTE "WRZESIE_        "›5220     .SBYTE "PADZIERNIK     "›5230     .SBYTE "LISTOPAD        "›5240     .SBYTE "GRUDZIE_        "›5250 ;›5260 TIMEUPPROC LDA HUMANPL,X›5270     TAY ›5280     CPY #255›5290     BEQ TIMEUPPROC1›5300     LDA KSZN,Y›5310     BEQ TIMEUPPROC1›5320     INC NMCY,X›5330 TIMEUPPROC1 RTS ›5340 ;›5350 TIMEUP LDX #0›5360     JSR TIMEUPPROC›5370     INX ›5380     JSR TIMEUPPROC›5390     INC MIESIAC›5400     LDA MIESIAC›5410     CMP #12›5420     BNE TIMEUP1›5430     LDA #0›5440     STA MIESIAC›5450     INC ROK›5460     BNE TIMEUP1›5470     INC ROK+1›5480 TIMEUP1 RTS ›5490 ;›5500 CHKGRTRUP LDX GRACZ›5510     LDA KSZN,X›5520     BNE CHKGRTRUP1›5530     LDA #255›5540     STA ARMPOS,X›5550     TXA ›5560     ASL A›5570     TAX ›5580     LDA #0›5590     STA DOCHZN,X›5600     STA DOCHZN+1,X›5610 CHKGRTRUP1 RTS ›5620 ;›5630 SCREENOFF LDA #1›5640     JSR WAIT›5650     LDX #9›5660     LDY #0›5670 SCREENOFF2 LDA COLORSBUFA,X›5680     AND #15›5690     BEQ SCREENOFF1›5700     DEC COLORSBUFA,X›5710     INY ›5720 SCREENOFF1 DEX ›5730     BPL SCREENOFF2›5740     TYA ›5750     BNE SCREENOFF›5760     LDX #9›5770     LDA #0›5780 SCREENOFF3 STA COLORSBUFA,X›5790     DEX ›5800     BPL SCREENOFF3›5810     LDY # <NULLPROC›5820     LDX # >NULLPROC›5830 SETVBLPROC LDA #1›5840     JSR WAIT›5850     STY USERVBLVECT›5860     STX USERVBLVECT+1›5870     RTS ›5880 ;›5890 CHKBUNT LDY #0›5900     LDX GRACZ›5910     CPX HUMANPL›5920     BEQ CHKBUNT3›5930     CPX HUMANPL+1›5940     BNE CHKBUNT1›5950     INY ›5960 CHKBUNT3 LDA NMCY,Y›5970     CMP #96     ; 6 LAT›5980     BEQ CHKBUNT2›5990     CMP #60     ; 5 LAT›6000     BCC CHKBUNT1›6010     LDA $D20A›6020     AND #3›6030     BNE CHKBUNT1›6040 CHKBUNT2 LDA ARMPOS,X›6050     TAY ›6060     TXA ›6070     JSR CRBUF›6080     JSR WOJKUPA›6090     LDX GRACZ›6100     LDA #0›6110     STA KSZN,X›6120     LDY #23›6130 CHKBUNT4 LDA KSTAB,Y›6140     CMP GRACZ›6150     BNE CHKBUNT5›6160     LDA #255›6170     STA KSTAB,Y›6180 CHKBUNT5 DEY ›6190     BPL CHKBUNT4›6200 CHKBUNT1 RTS ›6210 ;›6220 CHKPLENDPROC LDA HUMANPL,Y›6230     TAX ›6240     CPX #255›6250     BEQ CHKPLENDPROC1›6260     LDA KSZN,X›6270     BNE CHKPLENDPROC1›6280     TYA ›6290     PHA ›6300     JSR KONIECTRUP›6310     JSR PREPGRADL›6320     JSR REFRSCR›6330     LDA #50›6340     JSR WAIT›6350     PLA ›6360     TAY ›6370     LDA #255›6380     STA HUMANPL,Y›6390 CHKPLENDPROC1 RTS ›6400 ;›6410 CHKPLEND LDY #0›6420     JSR CHKPLENDPROC›6430     INY ›6440     JSR CHKPLENDPROC›6450     LDA HUMANPL›6460     AND HUMANPL+1›6470     CMP #255›6480     RTS ›6490 ;›6500 CHKPLWINPROC LDA HUMANPL,Y›6510     TAX ›6520     CPX #255›6530     BEQ CHKPLWINPROC1›6540     LDA KSZN,X›6550     CMP #24›6560     BNE CHKPLWINPROC1›6570     SEC ›6580     BCS CHKPLWINPROC2›6590 CHKPLWINPROC1 CLC ›6600 CHKPLWINPROC2 RTS ›6610 ;›6620 CHKPLWIN LDY #0›6630     JSR CHKPLWINPROC›6640     BCS CHKPLWIN1›6650     INY ›6660     JSR CHKPLWINPROC›6670 CHKPLWIN1 RTS ›6680 ;›6690 GRA JSR INITGRA›6700     LDA #0›6710     STA QUITZN›6720     STA GRACZ›6730     JSR REFRSCR›6740 GRA1 LDA #0›6750     STA GRACZ›6760     JSR SOJDOWN›6770 GRA2 JSR CHKBUNT›6780     JSR CHKGRTRUP›6790     BEQ GRA3›6800     JSR REFRSCR›6810     JSR PLOTMAN›6820     JSR RUCHGR›6830     JSR REFRSCR›6840     LDA #50›6850     JSR WAIT›6860 GRA3 JSR CHKPLEND›6870     BEQ GRA4›6880     JSR CHKPLWIN›6890     BCS GRA5›6900     LDA QUITZN›6910     BNE GRA6›6920     INC GRACZ›6930     LDA GRACZ›6940     CMP #4›6950     BNE GRA2›6960     JSR TIMEUP›6970     JMP GRA1›6980 GRA4 JMP SCREENOFF›6990 GRA5 LDA #50›7000     JSR WAIT›7010     JSR SCREENOFF›7020     JMP KONIECWIN›7030 GRA6 LDA #50›7040     JSR WAIT›7050     JSR SCREENOFF›7060     JMP KONIECBREAK›7070 ;›7080 MUSICON PHA ›7090     LDA #$70›7100     LDX # <MUZYKADAT›7110     LDY # >MUZYKADAT›7120     JSR MUZYKAPR+3›7130     PLA ›7140     TAX ›7150     LDA #$00›7160     JMP MUZYKAPR+3›7170 ;›7180 MUSICOFF LDA #$40›7190     JMP MUZYKAPR+3›7200 ;›7210 MUSICPLAY LDA MUSICZN›7220     BMI MUSICPLAY5›7230     LDA $D01F›7240     AND #$07›7250     CMP #$06›7260     BNE MUSICPLAY1›7270     LDA #$00›7280     STA MUSICZN›7290     BEQ MUSICPLAY2›7300 MUSICPLAY1 CMP #$05›7310     BNE MUSICPLAY2›7320     LDA #$01›7330     STA MUSICZN›7340 MUSICPLAY2 LDA MUSICZN›7350     BNE MUSICPLAY3›7360     JMP MUZYKAPR+6›7370 MUSICPLAY3 LDA #0›7380     LDY #8›7390 MUSICPLAY4 STA $D200,Y›7400     DEY ›7410     BPL MUSICPLAY4›7420 MUSICPLAY5 RTS ›7430 ;›7440 SELMANTXT1 .SBYTE "       GRACZ 1 - WYBIERZ POSTA\:        "›7450 SELMANTXT2 .SBYTE "           WPISZ SWOJE IMI]:            "›7460 SELMANTXT3 .SBYTE "      TA POSTA\ JEST JU WYBRANA!       "›7470 ;›7480 SELMAN LDY #31›7490 SELMAN1 LDA NAMPLDAT,Y›7500     STA NAMPLTAB,Y›7510     DEY ›7520     BPL SELMAN1›7530     STY HUMANPL+1›7540     STY IMMZN›7550     LDA #12›7560     STA $D012›7570     LDA #0›7580     JSR SELMANPROC›7590     STA HUMANPL›7600     JSR GETNAME›7610     LDA NOPCJA›7620     BEQ SELMAN2›7630 SELMAN3 LDA #1›7640     JSR SELMANPROC›7650     CMP HUMANPL›7660     BNE SELMAN4›7670     LDA # <SELMANTXT3›7680     LDY # >SELMANTXT3›7690     CLC ›7700     JSR PRINT›7710     SEC ›7720     JSR PRINTNULL›7730     LDA NOPCJA›7740     LSR A›7750     TAY ›7760     JSR WAITFIRE›7770     JMP SELMAN3›7780 SELMAN4 STA HUMANPL+1›7790     JSR GETNAME›7800 SELMAN2 LDA #0›7810     STA $D000›7820     RTS ›7830 ;›7840 SELMANPROC STA ZN›7850     LDA # <SELMANTXT1›7860     LDY # >SELMANTXT1›7870     CLC ›7880     JSR PRINT›7890     CLC ›7900     LDA ZN›7910     ADC #17›7920     STA INFOLINE+13›7930     SEC ›7940     JSR PRINTNULL›7950     LDA #0›7960     LDY #3›7970     STA XCEL›7980     STA XCELMIN›7990     STY XCELMAX›8000     TAY ›8010 SELMANPROC1 STA PMBASE+$0400,Y›8020     INY ›8030     BNE SELMANPROC1›8040     LDX #0›8050 SELMANPROC2 LDA DKURDAT,X›8060     STA PMBASE+$0400+80,Y›8070     INY ›8080     INY ›8090     INX ›8100     CPX #8›8110     BNE SELMANPROC2›8120 SELMANPROC3 LDY #0›8130     LDA NOPCJA›8140     CMP #2›8150     BNE SELMANPROC5›8160     LDY ZN›8170 SELMANPROC5 JSR GETJOY›8180     STA POM›8190     JSR CHKPOZ›8200     LDY XCEL›8210     LDA XKURSOJOPTTAB,Y›8220     STA $D000›8230     TYA ›8240     LDY #57›8250     JSR PRINTPLNAME›8260     LDA #4›8270     JSR WAIT›8280     LDY #0›8290     LDA NOPCJA›8300     CMP #2›8310     BNE SELMANPROC4›8320     LDY ZN›8330 SELMANPROC4 JSR GETFIRE›8340     BNE SELMANPROC3›8350     JSR WAITFIREB›8360     LDA XCEL›8370     RTS ›8380 ;›8390 GETKEY LDA #$00›8400     LDY #$40›8410     STA $D20E›8420     STY $D20E›8430 GETKEY1 LDA $D20E›8440     AND #$40›8450     BNE GETKEY1›8460     LDA $D209›8470     LDY #36›8480 GETKEY2 CMP KEYTAB1,Y›8490     BEQ GETKEY3›8500     DEY ›8510     BPL GETKEY2›8520     BMI GETKEY›8530 GETKEY3 LDA KEYTAB2,Y›8540     RTS ›8550 ;›8560 KEYTAB1 .BYTE $3F,$15,$12,$3A,$2A,$38,$3D,$39,$0D,$01,$05,$00,$25,$23,$08,$0A,$2F,$28,$3E,$2D›8570     .BYTE $0B,$10,$2E,$16,$2B,$17›8580     .BYTE $BF,$92,$AA,$80,$A3,$88,$BE,$97,$96,$34,$0C›8590 ;›8600 KEYTAB2 .SBYTE "ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_ þÿ"›8610 ;›8620 GETNAME PHA ›8630 GETNAME4 LDA # <SELMANTXT2›8640     LDY # >SELMANTXT2›8650     CLC ›8660     JSR PRINT›8670     SEC ›8680     JSR PRINTNULL›8690     LDA #0›8700     STA VZN›8710     LDA #$80›8720     STA MENULINE+17›8730 GETNAME1 JSR GETKEY›8740     CMP #254›8750     BEQ GETNAME4›8760     CMP #255›8770     BEQ GETNAME2›8780     LDY VZN›8790     STA MENULINE+17,Y›8800     LDA #$80›8810     STA MENULINE+18,Y›8820     LDA VZN›8830     CMP #$04›8840     BEQ GETNAME1›8850     INC VZN›8860     BNE GETNAME1›8870 GETNAME2 PLA ›8880     ASL A›8890     ASL A›8900     ASL A›8910     TAY ›8920     LDX #0›8930 GETNAME3 LDA MENULINE+17,X›8940     AND #127›8950     STA NAMPLTAB,Y›8960     INX ›8970     INY ›8980     CPX #5›8990     BNE GETNAME3›9000     JMP CHKIMM›9010 ;›9020 PASSWORD .SBYTE "SECOH"›9030 ;›9040 CHKIMM LDA IMMZN›9050     BEQ CHKIMM3›9060     LDY #4›9070     LDX #0›9080 CHKIMM1 LDA MENULINE+17,Y›9090     AND #127›9100     CMP PASSWORD,Y›9110     BEQ CHKIMM2›9120     INX ›9130 CHKIMM2 DEY ›9140     BPL CHKIMM1›9150     TXA ›9160     BNE CHKIMM3›9170     STA IMMZN›9180 CHKIMM3 RTS ›9190 ;›9200 INITGRA JSR PREPGRA›9210     JSR CLRSTAT›9220     JSR SELMAN›9230     LDA # <KSTAB›9240     LDX # >KSTAB›9250     LDY #0›9260     STA ZN›9270     STX ZN+1›9280     TYA ›9290 INITGRA1 STA (ZN),Y›9300     INC ZN›9310     BNE INITGRA2›9320     INC ZN+1›9330 INITGRA2 LDX ZN›9340     CPX # <BUFFER›9350     BNE INITGRA1›9360     LDX ZN+1›9370     CPX # >BUFFER›9380     BNE INITGRA2›9390     LDY #6›9400 INITGRA3 LDA #20›9410     STA WOJZN,Y›9420     STA KASAZN,Y›9430     LDA #0›9440     STA WOJZN+1,Y›9450     STA KASAZN+1,Y›9460     TYA ›9470     LSR A›9480     CMP HUMANPL›9490     BEQ INITGRA9›9500     CMP HUMANPL+1›9510     BNE INITGRA7›9520 INITGRA9 LDA IMMZN›9530     BNE INITGRA7›9540     LDA #255›9550     STA KASAZN,Y›9560     STA KASAZN+1,Y›9570     STA WOJZN,Y›9580     STA WOJZN+1,Y›9590     STA BUYSOLD›9600     STA BUYSOLD+1›9610     STA BUYSOLD+2›9620     STA BUYSOLD+3›9630 INITGRA7 DEY ›9640     DEY ›9650     BPL INITGRA3›9660     LDX #23›9670     LDA #255›9680 INITGRA4 STA KSTAB,X›9690     DEX ›9700     BPL INITGRA4›9710     LDX #3›9720 INITGRA5 CPX HUMANPL›9730     BEQ INITGRA8›9740     CPX HUMANPL+1›9750     BEQ INITGRA8›9760     LDA NOPCJA›9770     BEQ INITGRA8›9780     JSR FIND3KS›9790     JMP INITGRA6›9800 INITGRA8 JSR FIND1KS›9810 INITGRA6 DEX ›9820     BPL INITGRA5›9830     LDA #0›9840     LDY #237›9850     LDX #56›9860     STA MIESIAC›9870     STY ROK›9880     STX ROK+1›9890     LDA #0›9900     JMP SETSCR›9910 ;›9920 FINDKSPROC LDA $D20A›9930     AND #31›9940     CMP #24›9950     BCS FINDKSPROC›9960     TAY ›9970     LDA KSTAB,Y›9980     BPL FINDKSPROC›9990     TYA ›010000   RTS ›010010 ;›010020 FIND1KS JSR FINDKSPROC›010030   STA ARMPOS,X›010040   TXA ›010050   STA KSTAB,Y›010060   LDA #1›010070   STA KSZN,X›010080   RTS ›010090 ;›010100 FIND3KS STX VZN›010110 FIND3KS1 LDX VZN›010120   JSR FINDKSPROC›010130   STA VZN+1›010140   ASL A›010150   ASL A›010160   ASL A›010170   TAY ›010180   LDA NEARTAB,Y›010190   BMI FIND3KS1›010200   TAX ›010210   LDA KSTAB,X›010220   BPL FIND3KS1›010230   STX VZN+2›010240   INY ›010250   LDA NEARTAB,Y›010260   BMI FIND3KS1›010270   TAX ›010280   LDA KSTAB,X›010290   BPL FIND3KS1›010300   STX VZN+3›010310   LDA VZN›010320   STA KSTAB,X›010330   LDX VZN+2›010340   STA KSTAB,X›010350   LDX VZN+1›010360   STA KSTAB,X›010370   TAX ›010380   LDA #3›010390   STA KSZN,X›010400   LDA VZN+1›010410   STA ARMPOS,X›010420   RTS ›010430 ;›