1000 ;õ1010 ; MODUL: ÕŸ”Ãõ1020 ;õ1030 ;õ1040 RUCHGR JSR DOCHUPõ1050 RUCHGR14õ1060     LDA GRACZõ1070     CMP HUMANPLõ1080     BEQ RUCHGR11õ1090     CMP HUMANPL+1õ1100     BNE RUCHGR18õ1110 RUCHGR11 JMP MENUOBSõ1120 RUCHGR18 JSR WOJKUPAõ1130     JSR WOJDIVõ1140     LDA $D20Aõ1150     AND #7õ1160     BNE RUCHGR21õ1170     JMP RUCHGR10õ1180 RUCHGR21 JSR CHKFRKSõ1190     BEQ RUCHGR1õ1200     TXA õ1210     PHA õ1220     JSR WOJARMõ1230     PLA õ1240     TAX õ1250     LDA GRACZõ1260     STA KSTAB,Xõ1270     TAY õ1280     TXA õ1290     STA ARMPOS,Yõ1300     ASL Aõ1310     TAX õ1320     LDA #0õ1330     STA WOJKSTAB,Xõ1340     STA WOJKSTAB+1,Xõ1350     LDX GRACZõ1360     INC KSZN,Xõ1370     JMP RUCHGR20õ1380 RUCHGR1 JSR WOJKUPAõ1390     LDA GRACZõ1400     ASL Aõ1410     TAX õ1420     LDA WOJZN+1,Xõ1430     BNE RUCHGR2õ1440     LDA WOJZN,Xõ1450     CMP #100õ1460     BCS RUCHGR2õ1470     LDX GRACZõ1480     LDA KSZN,Xõ1490     CMP #3õ1500     BCC RUCHGR3õ1510     JSR WOJDIVõ1520     JSR CHKBDKSõ1530     LDA #3õ1540     CMP GRACZõ1550     BEQ RUCHGR5õ1560     JSR PROPSELLõ1570     BPL RUCHGR3õ1580 RUCHGR5 LDA #2õ1590     CMP GRACZõ1600     BEQ RUCHGR6õ1610     JSR PROPSELLõ1620     BPL RUCHGR3õ1630 RUCHGR6 LDA #1õ1640     CMP GRACZõ1650     BEQ RUCHGR4õ1660     JSR PROPSELLõ1670     BPL RUCHGR3õ1680 RUCHGR4 LDA #0õ1690     CMP GRACZõ1700     BEQ RUCHGR3õ1710     JSR PROPSELLõ1720     BMI RUCHGR15õ1730 RUCHGR3 JMP RUCHGR20õ1740 RUCHGR2 JSR WOJDIVõ1750 RUCHGR15 LDA $D20Aõ1760     TAY õ1770     CMP #10õ1780     BCS RUCHGR22õ1790     JSR PRWYZWANIEõ1800     JSR TURNIEJOPTõ1810     JMP RUCHGR20õ1820 RUCHGR22 TYA õ1830     BPL RUCHGR7õ1840     JSR WOJARMõ1850     JSR CHKODCõ1860     BEQ RUCHGR19õ1870     LDA $D20Aõ1880     AND #3õ1890     BNE RUCHGR8õ1900 RUCHGR19 JSR PREPATõ1910     BEQ RUCHGR9õ1920 RUCHGR8 JMP BITWAõ1930 RUCHGR9 RTS õ1940 RUCHGR7 CMP #64õ1950     BCC RUCHGR10õ1960     LDA GRACZõ1970     ASL Aõ1980     TAX õ1990     LDA KASAZN+1,Xõ2000     BEQ RUCHGR12õ2010     JSR CHKBUYõ2020     BNE RUCHGR13õ2030     BEQ RUCHGR20õ2040 RUCHGR10 LDA GRACZõ2050     ASL Aõ2060     TAX õ2070     LDA KASAZN+1,Xõ2080     BEQ RUCHGR12õ2090 RUCHGR13 LDA $D20Aõ2100     AND #1õ2110     BEQ RUCHGR12õ2120     JMP BUYWOJõ2130 RUCHGR12 JMP BUYWOJMAXõ2140 RUCHGR20 RTS õ2150 ;õ2160 WYZWANIETXT .SBYTE "       WYZWA^ CI] NA TURNIEJ ^UCZNICZY  "õ2170 ;õ2180 PRWYZWANIE LDA # <WYZWANIETXTõ2190     LDY # >WYZWANIETXTõ2200     CLC õ2210     JSR PRINTõ2220     SEC õ2230     JSR PRINTNULLõ2240     LDY #1õ2250     LDA GRACZõ2260     JSR PRINTPLNAMEõ2270     LDY #255õ2280     JMP WAITFIREõ2290 ;õ2300 SOJDOWN LDX #$00õ2310 SOJDOWN1 LDA SOJTAB,Xõ2320     BEQ SOJDOWN2õ2330     DEC SOJTAB,Xõ2340 SOJDOWN2 INX õ2350     CPX #$10õ2360     BNE SOJDOWN1õ2370     RTS õ2380 ;õ2390 DOCHUP LDX GRACZõ2400     LDA ARMPOS,Xõ2410     TAY õ2420     TXA õ2430     JSR CRBUFõ2440     LDY #0õ2450     STY ZNõ2460     STY ZN+1õ2470 DOCHUP3 LDA BUFFER,Yõ2480     BMI DOCHUP1õ2490     TAX õ2500     LDA DOCHTAB,Xõ2510     CLC õ2520     ADC ZNõ2530     STA ZNõ2540     BCC DOCHUP2õ2550     INC ZN+1õ2560 DOCHUP2 INY õ2570     CPY #24õ2580     BNE DOCHUP3õ2590 DOCHUP1 LDA GRACZõ2600     TAY õ2610     ASL Aõ2620     PHA õ2630     TAX õ2640     CPY HUMANPLõ2650     BEQ DOCHUP5õ2660     CPY HUMANPL+1õ2670     BEQ DOCHUP5õ2680     ASL ZNõ2690     ROL ZN+1õ2700 DOCHUP5 LDA ZNõ2710     STA DOCHZN,Xõ2720     LDA ZN+1õ2730     STA DOCHZN+1,Xõ2740     JSR SPISEKõ2750     PLA õ2760     TAX õ2770     CLC õ2780     LDA KASAZN,Xõ2790     ADC DOCHZN,Xõ2800     STA ZNõ2810     LDA KASAZN+1,Xõ2820     ADC DOCHZN+1,Xõ2830     STA ZN+1õ2840     BCC DOCHUP4õ2850     LDA #255õ2860     STA ZNõ2870     STA ZN+1õ2880 DOCHUP4 LDA ZNõ2890     STA KASAZN,Xõ2900     LDA ZN+1õ2910     STA KASAZN+1,Xõ2920     RTS õ2930 ;õ2940 CHKFRKS LDY #1õ2950     STY ZNõ2960     DEY õ2970 CHKFRKS4 LDA BUFFER,Yõ2980     BMI CHKFRKS5õ2990     TAX õ3000     TYA õ3010     PHA õ3020     TXA õ3030     ASL Aõ3040     ASL Aõ3050     ASL Aõ3060     TAY õ3070     LDA #8õ3080     STA ZN+2õ3090 CHKFRKS3 LDA NEARTAB,Yõ3100     BMI CHKFRKS1õ3110     TAX õ3120     LDA KSTAB,Xõ3130     BPL CHKFRKS2õ3140     LDA DOCHTAB,Xõ3150     CMP ZNõ3160     BCC CHKFRKS2õ3170     STA ZNõ3180     STX ZN+1õ3190 CHKFRKS2 INY õ3200     DEC ZN+2õ3210     BNE CHKFRKS3õ3220 CHKFRKS1 PLA õ3230     TAY õ3240     INY õ3250     CPY #24õ3260     BNE CHKFRKS4õ3270 CHKFRKS5 LDX ZN+1õ3280     LDY ZNõ3290     CPY #1õ3300     RTS õ3310 ;õ3320 CRBUF STA ZNõ3330     STY ZN+1õ3340     JSR CLRBUFõ3350     LDA ZN+1õ3360     JSR PUTBUFõ3370     LDA #0õ3380     STA ZN+1õ3390 CRBUF4 LDY ZN+1õ3400     LDA BUFFER,Yõ3410     BMI CRBUF1õ3420     ASL Aõ3430     ASL Aõ3440     ASL Aõ3450     TAY õ3460     LDA #8õ3470     STA ZN+2õ3480 CRBUF3 LDA NEARTAB,Yõ3490     BMI CRBUF2õ3500     TAX õ3510     LDA KSTAB,Xõ3520     CMP ZNõ3530     BNE CRBUF5õ3540     TXA õ3550     JSR PUTBUFõ3560 CRBUF5 INY õ3570     DEC ZN+2õ3580     BNE CRBUF3õ3590 CRBUF2 INC ZN+1õ3600     LDA ZN+1õ3610     CMP #24õ3620     BNE CRBUF4õ3630 CRBUF1 RTS õ3640 ;õ3650 CLRBUF LDX #23õ3660     LDA #255õ3670 CLRBUF1 STA BUFFER,Xõ3680     DEX õ3690     BPL CLRBUF1õ3700     RTS õ3710 ;õ3720 PUTBUF LDX #23õ3730 PUTBUF1 CMP BUFFER,Xõ3740     BEQ PUTBUF2õ3750     DEX õ3760     BPL PUTBUF1õ3770     PHA õ3780     LDX #0õ3790 PUTBUF3 LDA BUFFER,Xõ3800     BMI PUTBUF4õ3810     INX õ3820     BNE PUTBUF3õ3830 PUTBUF4 PLA õ3840     STA BUFFER,Xõ3850 PUTBUF2 RTS õ3860 ;õ3870 WOJKUPA LDY #0õ3880 WOJKUPA1 LDA BUFFER,Yõ3890     BMI WOJKUPA2õ3900     ASL Aõ3910     TAX õ3920     TYA õ3930     PHA õ3940     LDA GRACZõ3950     ASL Aõ3960     TAY õ3970     CLC õ3980     LDA WOJZN,Yõ3990     ADC WOJKSTAB,Xõ4000     STA ZNõ4010     LDA WOJZN+1,Yõ4020     ADC WOJKSTAB+1,Xõ4030     STA ZN+1õ4040     BCC WOJKUPA3õ4050     LDA #255õ4060     STA ZNõ4070     STA ZN+1õ4080 WOJKUPA3 LDA ZNõ4090     STA WOJZN,Yõ4100     LDA ZN+1õ4110     STA WOJZN+1,Yõ4120     LDA #0õ4130     STA WOJKSTAB,Xõ4140     STA WOJKSTAB+1,Xõ4150     PLA õ4160     TAY õ4170     INY õ4180     CPY #24õ4190     BNE WOJKUPA1õ4200 WOJKUPA2 RTS õ4210 ;õ4220 CHKBDKS LDA #0õ4230     STA ZNõ4240 CHKBDKS3 LDA #0õ4250     STA ZN+1õ4260     INC ZNõ4270     LDY #23õ4280 CHKBDKS2 LDA GRACZõ4290     CMP KSTAB,Yõ4300     BNE CHKBDKS1õ4310     TAX õ4320     TYA õ4330     CMP ARMPOS,Xõ4340     BEQ CHKBDKS1õ4350     LDA DOCHTAB,Yõ4360     CMP ZNõ4370     BNE CHKBDKS1õ4380     INC ZN+1õ4390 CHKBDKS1 DEY õ4400     BPL CHKBDKS2õ4410     LDA ZN+1õ4420     BEQ CHKBDKS3õ4430     LDA #254õ4440     STA ZN+1õ4450     LDY #23õ4460 CHKBDKS14 LDA GRACZõ4470     CMP KSTAB,Yõ4480     BNE CHKBDKS4õ4490     TAX õ4500     TYA õ4510     CMP ARMPOS,Xõ4520     BEQ CHKBDKS4õ4530     LDA DOCHTAB,Yõ4540     CMP ZNõ4550     BNE CHKBDKS4õ4560     TYA õ4570     PHA õ4580     ASL Aõ4590     ASL Aõ4600     ASL Aõ4610     TAY õ4620     LDA #8õ4630     STA ZN+2õ4640     LDA #0õ4650     STA ZN+3õ4660     STA ZN+4õ4670 CHKBDKS7 LDA NEARTAB,Yõ4680     BMI CHKBDKS5õ4690     INC ZN+3õ4700     TAX õ4710     LDA KSTAB,Xõ4720     CMP GRACZõ4730     BNE CHKBDKS6õ4740     INC ZN+4õ4750 CHKBDKS6 INY õ4760     DEC ZN+2õ4770     BNE CHKBDKS7õ4780     BEQ CHKBDKS5õ4790 CHKBDKS4 JMP CHKBDKS12õ4800 CHKBDKS5 LDX #1õ4810     LDA ZN+3õ4820     STA ZN+2õ4830 CHKBDKS8 LDA ZN+2õ4840     CMP #210õ4850     BCS CHKBDKS9õ4860     ADC ZN+3õ4870     STA ZN+2õ4880     INX õ4890     BNE CHKBDKS8õ4900 CHKBDKS9 LDA ZN+4õ4910     STA ZN+2õ4920 CHKBDKS10 DEX õ4930     BEQ CHKBDKS11õ4940     CLC õ4950     LDA ZN+2õ4960     ADC ZN+4õ4970     STA ZN+2õ4980     BCC CHKBDKS10õ4990 CHKBDKS11 PLA õ5000     TAY õ5010     LDA ZN+2õ5020     CMP ZN+1õ5030     BCS CHKBDKS12õ5040     STA ZN+1õ5050     STY ZN+5õ5060 CHKBDKS12 DEY õ5070     BMI CHKBDKS13õ5080     JMP CHKBDKS14õ5090 CHKBDKS13 LDA $D20Aõ5100     CMP #100õ5110     BCC CHKBDKS13õ5120     LDX ZN+5õ5130     TAY õ5140     RTS õ5150 ;õ5160 PROPSELL STA ZNõ5170     STY ZN+1õ5180     STX ZN+2õ5190     LDA #255õ5200     STA ZN+3õ5210     LDX ZNõ5220     LDA KSZN,Xõ5230     BEQ PROPSELL2õ5240     CPX HUMANPLõ5250     BEQ PROPSELL11õ5260     CPX HUMANPL+1õ5270     BNE PROPSELL1õ5280 PROPSELL11 JMP PROPSELLGõ5290 PROPSELL1 LDA ZN+2õ5300     ASL Aõ5310     ASL Aõ5320     ASL Aõ5330     TAY õ5340     LDA #8õ5350     STA ZN+4õ5360     LDA #0õ5370     STA ZN+5õ5380 PROPSELL8 LDA NEARTAB,Yõ5390     BMI PROPSELL9õ5400     TAX õ5410     LDA KSTAB,Xõ5420     BMI PROPSELL10õ5430     CMP ZNõ5440     BNE PROPSELL10õ5450     INC ZN+5õ5460 PROPSELL10 INY õ5470     DEC ZN+4õ5480     BNE PROPSELL8õ5490 PROPSELL9 LDA ZN+5õ5500     BEQ PROPSELL2õ5510     LDA $D20Aõ5520     AND #1õ5530     BEQ PROPSELL2õ5540     LDA ZNõ5550     ASL Aõ5560     TAX õ5570     LDA KASAZN+1,Xõ5580     BNE PROPSELL3õ5590     LDA KASAZN,Xõ5600     CMP ZN+1õ5610     BCS PROPSELL3õ5620 PROPSELL2 JMP PROPSELL4õ5630 PROPSELL3 LDA $D20Aõ5640     CMP #100õ5650     BCC PROPSELL3õ5660     CMP ZN+1õ5670     BCC PROPSELL2õ5680 PROPSELLPROC LDA ZNõ5690     ASL Aõ5700     TAX õ5710     SEC õ5720     LDA KASAZN,Xõ5730     SBC ZN+1õ5740     STA KASAZN,Xõ5750     BCS PROPSELL5õ5760     DEC KASAZN+1,Xõ5770 PROPSELL5 LDA GRACZõ5780     ASL Aõ5790     TAY õ5800     CLC õ5810     LDA KASAZN,Yõ5820     ADC ZN+1õ5830     STA ZN+4õ5840     LDA KASAZN+1,Yõ5850     ADC #0õ5860     STA ZN+5õ5870     BCC PROPSELL6õ5880     LDA #255õ5890     STA ZN+4õ5900     STA ZN+5õ5910 PROPSELL6 LDA ZN+4õ5920     STA KASAZN,Yõ5930     LDA ZN+5õ5940     STA KASAZN+1,Yõ5950     LDX ZN+2õ5960     LDA ZNõ5970     STA KSTAB,Xõ5980     TXA õ5990     ASL Aõ6000     TAX õ6010     CLC õ6020     LDA WOJZN,Yõ6030     ADC WOJKSTAB,Xõ6040     STA ZN+4õ6050     LDA WOJZN+1,Yõ6060     ADC WOJKSTAB+1,Xõ6070     STA ZN+5õ6080     BCC PROPSELL7õ6090     LDA #255õ6100     STA ZN+4õ6110     STA ZN+5õ6120 PROPSELL7 LDA ZN+4õ6130     STA WOJZN,Yõ6140     LDA ZN+5õ6150     STA WOJZN+1,Yõ6160     LDA #0õ6170     STA WOJKSTAB,Xõ6180     STA WOJKSTAB+1,Xõ6190     LDX GRACZõ6200     DEC KSZN,Xõ6210     LDX ZNõ6220     INC KSZN,Xõ6230     LDA #0õ6240     STA ZN+3õ6250 PROPSELL4 LDY ZN+1õ6260     LDX ZN+2õ6270     LDA ZN+3õ6280     RTS õ6290 ;õ6300 WOJDIV LDY #0õ6310     STY ZNõ6320 WOJDIV1 LDA BUFFER,Yõ6330     BMI WOJDIV2õ6340     ASL Aõ6350     ASL Aõ6360     ASL Aõ6370     TAX õ6380     TYA õ6390     PHA õ6400     LDA #0õ6410     STA ZN+1õ6420     LDA #8õ6430     STA ZN+2õ6440 WOJDIV3 LDA NEARTAB,Xõ6450     BMI WOJDIV4õ6460     TAY õ6470     LDA KSTAB,Yõ6480     BMI WOJDIV5õ6490     CMP GRACZõ6500     BEQ WOJDIV5õ6510     INC ZN+1õ6520 WOJDIV5 INX õ6530     DEC ZN+2õ6540     BNE WOJDIV3õ6550 WOJDIV4 PLA õ6560     TAY õ6570     LDA ZN+1õ6580     BEQ WOJDIV6õ6590     LDA BUFFER,Yõ6600     ORA #32õ6610     STA BUFFER,Yõ6620     INC ZNõ6630 WOJDIV6 INY õ6640     CPY #24õ6650     BNE WOJDIV1õ6660 WOJDIV2 LDA ZNõ6670     BEQ WOJDIV9õ6680     LDA GRACZõ6690     ASL Aõ6700     TAX õ6710     LDY #0õ6720     STY ZN+1õ6730     STY ZN+2õ6740 WOJDIV7 SEC õ6750     LDA WOJZN,Xõ6760     SBC ZNõ6770     STA ZN+3õ6780     LDA WOJZN+1,Xõ6790     SBC #0õ6800     STA ZN+4õ6810     BCC WOJDIV8õ6820     LDA ZN+3õ6830     STA WOJZN,Xõ6840     LDA ZN+4õ6850     STA WOJZN+1,Xõ6860     INC ZN+1õ6870     BNE WOJDIV7õ6880     INC ZN+2õ6890     BNE WOJDIV7õ6900 WOJDIV8 LDA BUFFER,Yõ6910     BMI WOJDIV9õ6920     STA ZN+3õ6930     AND #32õ6940     BEQ WOJDIV10õ6950     LDA ZN+3õ6960     STY ZN+3õ6970     AND #31õ6980     STA BUFFER,Yõ6990     ASL Aõ7000     TAY õ7010     LDA ZN+1õ7020     STA WOJKSTAB,Yõ7030     LDA ZN+2õ7040     STA WOJKSTAB+1,Yõ7050     LDY ZN+3õ7060 WOJDIV10 INY õ7070     CPY #24õ7080     BNE WOJDIV8õ7090 WOJDIV9 RTS õ7100 ;õ7110 WOJARM LDY #0õ7120 WOJARM1 LDA BUFFER,Yõ7130     BMI WOJARM2õ7140     ASL Aõ7150     TAX õ7160     LDA WOJKSTAB+1,Xõ7170     LSR Aõ7180     STA WOJKSTAB+1,Xõ7190     STA ZN+1õ7200     LDA WOJKSTAB,Xõ7210     ROR Aõ7220     STA WOJKSTAB,Xõ7230     STA ZNõ7240     BCC WOJARM3õ7250     INC ZNõ7260     BNE WOJARM3õ7270     INC ZN+1õ7280 WOJARM3 LDA GRACZõ7290     ASL Aõ7300     TAX õ7310     CLC õ7320     LDA ZNõ7330     ADC WOJZN,Xõ7340     STA ZNõ7350     LDA ZN+1õ7360     ADC WOJZN+1,Xõ7370     STA ZN+1õ7380     BCC WOJARM4õ7390     LDA #255õ7400     STA WOJZN,Xõ7410     STA WOJZN+1,Xõ7420     BMI WOJARM2õ7430 WOJARM4 LDA ZNõ7440     STA WOJZN,Xõ7450     LDA ZN+1õ7460     STA WOJZN+1,Xõ7470     INY õ7480     CPY #24õ7490     BNE WOJARM1õ7500 WOJARM2 RTS õ7510 ;õ7520 CHKODC LDY #0õ7530     STY ZNõ7540     STY ZN+1õ7550 CHKODC1 LDA BUFFER,Yõ7560     BMI CHKODC2õ7570     INC ZNõ7580 CHKODC2 LDA KSTAB,Yõ7590     CMP GRACZõ7600     BNE CHKODC3õ7610     INC ZN+1õ7620 CHKODC3 INY õ7630     CPY #24õ7640     BNE CHKODC1õ7650     SEC õ7660     LDA ZN+1õ7670     SBC ZNõ7680     BEQ CHKODC4õ7690     LDY #0õ7700 CHKODC5 LDA KSTAB,Yõ7710     CMP GRACZõ7720     BNE CHKODC6õ7730     TYA õ7740     LDX #23õ7750 CHKODC7 CMP BUFFER,Xõ7760     BEQ CHKODC6õ7770     DEX õ7780     BPL CHKODC7õ7790     STA ZN+1õ7800     ASL Aõ7810     ASL Aõ7820     ASL Aõ7830     TAY õ7840     LDA #8õ7850     STA ZN+2õ7860 CHKODC14 LDA NEARTAB,Yõ7870     BMI CHKODC8õ7880     ASL Aõ7890     ASL Aõ7900     ASL Aõ7910     TAX õ7920     LDA #8õ7930     STA ZN+3õ7940 CHKODC13 LDA NEARTAB,Xõ7950     BMI CHKODC9õ7960     STA ZN+5õ7970     STX ZN+4õ7980     TAX õ7990     LDA KSTAB,Xõ8000     CMP GRACZõ8010     BNE CHKODC10õ8020     LDX #23õ8030     LDA ZN+5õ8040 CHKODC12 CMP BUFFER,Xõ8050     BEQ CHKODC11õ8060     DEX õ8070     BPL CHKODC12õ8080     BMI CHKODC10õ8090 CHKODC11 LDA ZN+4õ8100     LSR Aõ8110     LSR Aõ8120     LSR Aõ8130     TAY õ8140     LDX ZN+5õ8150     LDA #255õ8160     RTS õ8170 CHKODC10 LDX ZN+4õ8180     INX õ8190     DEC ZN+3õ8200     BNE CHKODC13õ8210 CHKODC9 INY õ8220     DEC ZN+2õ8230     BNE CHKODC14õ8240 CHKODC8 LDY ZN+1õ8250 CHKODC6 INY õ8260     CPY #24õ8270     BNE CHKODC5õ8280 CHKODC4 LDA #0õ8290     RTS õ8300 ;õ8310 PREPAT LDY #0õ8320     STY ZN+5õ8330     STY ZN+9õ8340 PREPAT1 LDA BUFFER,Yõ8350     BMI PREPAT2õ8360     ASL Aõ8370     ASL Aõ8380     ASL Aõ8390     TAX õ8400     TYA õ8410     PHA õ8420     LDA #8õ8430     STA ZN+4õ8440 PREPAT3 LDA NEARTAB,Xõ8450     BMI PREPAT4õ8460     TAY õ8470     LDA KSTAB,Yõ8480     BMI PREPAT15õ8490     CMP GRACZõ8500     BEQ PREPAT15õ8510     ASL Aõ8520     ASL Aõ8530     ORA GRACZõ8540     TAY õ8550     LDA SOJTAB,Yõ8560     BNE PREPAT15õ8570     INC ZN+5õ8580 PREPAT15 INX õ8590     DEC ZN+4õ8600     BNE PREPAT3õ8610 PREPAT4 PLA õ8620     TAY õ8630     INY õ8640     CPY #24õ8650     BNE PREPAT1õ8660 PREPAT2 LDA ZN+5õ8670     BNE PREPAT18õ8680     LDA GRACZõ8690     TAX õ8700     ASL Aõ8710     ASL Aõ8720     TAY õ8730     LDA #0õ8740     STA SOJTAB,Yõ8750     STA SOJTAB+1,Yõ8760     STA SOJTAB+2,Yõ8770     STA SOJTAB+3,Yõ8780     STA SOJTAB,Xõ8790     STA SOJTAB+4,Xõ8800     STA SOJTAB+8,Xõ8810     STA SOJTAB+12,Xõ8820     JMP PREPATõ8830 PREPAT18 LDA $D20Aõ8840     BMI PREPAT5õ8850 PREPAT6 CMP ZN+5õ8860     BCC PREPAT7õ8870     SBC ZN+5õ8880     JMP PREPAT6õ8890 PREPAT7 TAY õ8900     INY õ8910     STY ZN+9õ8920 PREPAT5 LDY #0õ8930     STY ZN+4õ8940 PREPAT10 LDA BUFFER,Yõ8950     BMI PREPAT11õ8960     ASL Aõ8970     ASL Aõ8980     ASL Aõ8990     TAX õ9000     TYA õ9010     PHA õ9020     LDA #8õ9030     STA ZN+6õ9040 PREPAT12 LDA NEARTAB,Xõ9050     BMI PREPAT13õ9060     TAY õ9070     LDA KSTAB,Yõ9080     BMI PREPAT14õ9090     CMP GRACZõ9100     BEQ PREPAT14õ9110     STY ZN+8õ9120     ASL Aõ9130     ASL Aõ9140     ORA GRACZõ9150     TAY õ9160     LDA SOJTAB,Yõ9170     BNE PREPAT14õ9180     LDY ZN+8õ9190     LDA DOCHTAB,Yõ9200     DEC ZN+9õ9210     BNE PREPAT8õ9220     STA ZN+4õ9230     STY ZN+5õ9240     TXA õ9250     LSR Aõ9260     LSR Aõ9270     LSR Aõ9280     STA ZN+7õ9290     PLA õ9300     JMP PREPAT11õ9310 PREPAT8 CMP ZN+4õ9320     BCC PREPAT14õ9330     STA ZN+4õ9340     STY ZN+5õ9350     TXA õ9360     LSR Aõ9370     LSR Aõ9380     LSR Aõ9390     STA ZN+7õ9400 PREPAT14 INX õ9410     DEC ZN+6õ9420     BNE PREPAT12õ9430 PREPAT13 PLA õ9440     TAY õ9450     INY õ9460     CPY #24õ9470     BNE PREPAT10õ9480 PREPAT11 LDY #3õ9490     LDX ZN+5õ9500     LDA KSTAB,Xõ9510     STA ZN+6õ9520 PREPAT16 CPY GRACZõ9530     BEQ PREPAT17õ9540     CPY ZN+6õ9550     BEQ PREPAT17õ9560     LDA KSZN,Yõ9570     BEQ PREPAT17õ9580     TYA õ9590     ASL Aõ9600     ASL Aõ9610     ORA GRACZõ9620     TAX õ9630     LDA SOJTAB,Xõ9640     BNE PREPAT17õ9650     LDA $D20Aõ9660     AND #1õ9670     BNE PREPAT17õ9680     TYA õ9690     PHA õ9700     JSR PROPSOJõ9710     PLA õ9720     TAY õ9730 PREPAT17 DEY õ9740     BPL PREPAT16õ9750     LDY ZN+5õ9760     LDX ZN+7õ9770     LDA ZN+4õ9780     RTS õ9790 ;õ9800 PROPSOJ LDA KSZN,Yõ9810     SEC õ9820     BEQ PROPSOJ4õ9830     CPY HUMANPLõ9840     BEQ PROPSOJ6õ9850     CPY HUMANPL+1õ9860     BNE PROPSOJ1õ9870 PROPSOJ6 JMP PROPSOJGõ9880 PROPSOJ1 LDA $D20Aõ9890     PHA õ9900     LDX GRACZõ9910     LDA KSZN,Yõ9920     CMP KSZN,Xõ9930     PLA õ9940     BCS PROPSOJ2õ9950     CMP #128õ9960     BCC PROPSOJ3õ9970     BCS PROPSOJ4õ9980 PROPSOJ2 CMP #64õ9990     BCS PROPSOJ4õ010000 PROPSOJ3õ010010 PROPSOJPROC LDA ZNõ010020   PHA õ010030   LDA ZN+1õ010040   PHA õ010050   STY ZNõ010060   STX ZN+1õ010070   TYA õ010080   ASL Aõ010090   ASL Aõ010100   ORA ZN+1õ010110   TAY õ010120   TXA õ010130   ASL Aõ010140   ASL Aõ010150   ORA ZNõ010160   TAX õ010170 PROPSOJ5 LDA $D20Aõ010180   AND #$07õ010190   CMP #6õ010200   BCS PROPSOJ5õ010210   ADC #1õ010220   STA SOJTAB,Yõ010230   STA SOJTAB,Xõ010240   PLA õ010250   STA ZN+1õ010260   PLA õ010270   STA ZNõ010280   CLC õ010290   LDA #255õ010300 PROPSOJ4 TAY õ010310   RTS õ010320 ;õ010330 CHKBUY LDY #1õ010340   STY ZNõ010350   DEY õ010360 CHKBUY1 LDA BUFFER,Yõ010370   BMI CHKBUY2õ010380   ASL Aõ010390   ASL Aõ010400   ASL Aõ010410   TAX õ010420   TYA õ010430   PHA õ010440   LDA #8õ010450   STA ZN+3õ010460 CHKBUY3 LDA NEARTAB,Xõ010470   BMI CHKBUY4õ010480   TAY õ010490   LDA KSTAB,Yõ010500   BMI CHKBUY5õ010510   CMP GRACZõ010520   BEQ CHKBUY5õ010530   LDA DOCHTAB,Yõ010540   CMP ZNõ010550   BCC CHKBUY5õ010560   STA ZNõ010570   STY ZN+1õ010580   LDA KSTAB,Yõ010590   STA ZN+2õ010600 CHKBUY5 INX õ010610   DEC ZN+3õ010620   BNE CHKBUY3õ010630 CHKBUY4 PLA õ010640   TAY õ010650   INY õ010660   CPY #24õ010670   BNE CHKBUY1õ010680 CHKBUY2 LDA ZNõ010690   CMP #1õ010700   BEQ CHKBUY6õ010710 CHKBUY7 LDA $D20Aõ010720   CMP #100õ010730   BCC CHKBUY7õ010740   LDY ZN+1õ010750   LDX ZN+2õ010760   JMP PROPBUYõ010770 CHKBUY6 RTS õ010780 ;õ010790 PROPBUY STA ZNõ010800   STY ZN+1õ010810   STX ZN+2õ010820   LDA #255õ010830   STA ZN+3õ010840   CPX HUMANPLõ010850   BEQ PROPBUY11õ010860   CPX HUMANPL+1õ010870   BNE PROPBUY1õ010880 PROPBUY11 JMP PROPBUYGõ010890 PROPBUY1 LDA KSZN,Xõ010900   CMP #6õ010910   BCC PROPBUY2õ010920   LDA #0õ010930   STA ZN+4õ010940   LDA ZN+1õ010950   ASL Aõ010960   ASL Aõ010970   ASL Aõ010980   TAX õ010990   LDA #8õ011000   STA ZN+5õ011010 PROPBUY4 LDA NEARTAB,Xõ011020   BMI PROPBUY3õ011030   TAY õ011040   LDA KSTAB,Yõ011050   CMP ZN+2õ011060   BNE PROPBUY5õ011070   INC ZN+4õ011080 PROPBUY5 INX õ011090   DEC ZN+5õ011100   BNE PROPBUY4õ011110 PROPBUY3 LDA ZN+4õ011120   CMP #3õ011130   BCS PROPBUY2õ011140   LDY ZN+2õ011150   LDA ARMPOS,Yõ011160   CMP ZN+1õ011170   BEQ PROPBUY2õ011180   LDA $D20Aõ011190   AND #1õ011200   BNE PROPBUY2õ011210   LDY ZN+1õ011220   LDA DOCHTAB,Yõ011230   ASL Aõ011240   STA ZN+4õ011250 PROPBUY6 LDA $D20Aõ011260   CMP ZN+4õ011270   BCC PROPBUY6õ011280   CMP ZNõ011290   BEQ PROPBUY8õ011300   BCC PROPBUY8õ011310 PROPBUY2 JMP PROPBUY7õ011320 PROPBUY8õ011330 PROPBUYPROC LDX GRACZõ011340   INC KSZN,Xõ011350   LDX ZN+2õ011360   DEC KSZN,Xõ011370   LDA #0õ011380   STA ZN+3õ011390   TXA õ011400   ASL Aõ011410   TAY õ011420   LDA ZN+1õ011430   ASL Aõ011440   TAX õ011450   CLC õ011460   LDA WOJZN,Yõ011470   ADC WOJKSTAB,Xõ011480   STA ZN+4õ011490   LDA WOJZN+1,Yõ011500   ADC WOJKSTAB+1,Xõ011510   STA ZN+5õ011520   BCC PROPBUY9õ011530   LDA #255õ011540   STA ZN+4õ011550   STA ZN+5õ011560 PROPBUY9 LDA ZN+4õ011570   STA WOJZN,Yõ011580   LDA ZN+5õ011590   STA WOJZN+1,Yõ011600   LDA #0õ011610   STA WOJKSTAB,Xõ011620   STA WOJKSTAB+1,Xõ011630   LDX ZN+1õ011640   LDA GRACZõ011650   STA KSTAB,Xõ011660   CLC õ011670   LDA KASAZN,Yõ011680   ADC ZNõ011690   STA ZN+4õ011700   LDA KASAZN+1,Yõ011710   ADC #0õ011720   STA ZN+5õ011730   BCC PROPBUY10õ011740   LDA #255õ011750   STA ZN+4õ011760   STA ZN+5õ011770 PROPBUY10 LDA ZN+4õ011780   STA KASAZN,Yõ011790   LDA ZN+5õ011800   STA KASAZN+1,Yõ011810   LDA GRACZõ011820   ASL Aõ011830   TAX õ011840   SEC õ011850   LDA KASAZN,Xõ011860   SBC ZNõ011870   STA KASAZN,Xõ011880   BCS PROPBUY7õ011890   DEC KASAZN+1,Xõ011900 PROPBUY7 LDA ZN+3õ011910   RTS õ011920 ;õ011930 BUYWOJ LDA #0õ011940   LDY #1õ011950   BEQ BUYWOJ1õ011960 ;õ011970 BUYWOJMAX LDA #0õ011980   TAY õ011990 ;õ012000 BUYWOJ1 STA ZNõ012010   STY ZN+1õ012020   LDA GRACZõ012030   ASL Aõ012040   TAX õ012050   SEC õ012060   LDA KASAZN,Xõ012070   SBC ZNõ012080   STA ZN+2õ012090   LDA KASAZN+1,Xõ012100   SBC ZN+1õ012110   STA ZN+3õ012120   LDA ZNõ012130   STA KASAZN,Xõ012140   LDA ZN+1õ012150   STA KASAZN+1,Xõ012160   CLC õ012170   LDA WOJZN,Xõ012180   ADC ZN+2õ012190   STA ZNõ012200   LDA WOJZN+1,Xõ012210   ADC ZN+3õ012220   STA ZN+1õ012230   BCC BUYWOJ2õ012240   LDA #255õ012250   STA ZNõ012260   STA ZN+1õ012270 BUYWOJ2 LDA ZNõ012280   STA WOJZN,Xõ012290   LDA ZN+1õ012300   STA WOJZN+1,Xõ012310   RTS õ012320 ;õ