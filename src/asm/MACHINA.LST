1000 ;õ1010 ; MODUL: Õ¡√»…Œ¡õ1020 ;õ1030 ;õ1040 KULEDAT .SBYTE "         KULE DO KATAPULTY:             "õ1050 ;õ1060 MACHINA LDA ZNõ1070     PHA õ1080     LDA ZN+1õ1090     PHA õ1100     LDA ZN+2õ1110     PHA õ1120     LDA ZN+3õ1130     PHA õ1140     LDX #0õ1150     LDA GRACZõ1160     CMP HUMANPLõ1170     BEQ MACHINA11õ1180     INX õ1190 MACHINA11 STX ZN+3õ1200     INC NOBL,Xõ1210     BNE MACHINA8õ1220     LDA #255õ1230     STA NOBL,Xõ1240 MACHINA8 LDA $D20Aõ1250     AND #1õ1260     CLC õ1270     ADC #3õ1280     JSR SETSCRõ1290     LDA #0õ1300     JSR PLMURFAZAõ1310     LDA #0õ1320     JSR PLMACHPOSõ1330     LDA # <KULEDATõ1340     LDY # >KULEDATõ1350     CLC õ1360     JSR PRINTõ1370     SEC õ1380     JSR PRINTNULLõ1390     LDA #13õ1400     LDY #9õ1410     LDX #0õ1420     STA ZNõ1430     STY ZN+1õ1440     STX ZN+2õ1450 MACHINA2 LDA #0õ1460     LDY #9õ1470     STA YCELMINõ1480     STY YCELõ1490     STY YCELMAXõ1500     DEC ZNõ1510     LDA #255õ1520     CLC õ1530     PHP õ1540     LDA ZNõ1550     LDY #0õ1560     LDX #28õ1570     PLP õ1580     JSR CONVDECõ1590     SEC õ1600     LDA ZN+1õ1610     BEQ MACHINA15õ1620     CLC õ1630     LDA ZNõ1640     BNE MACHINA1õ1650 MACHINA15 JMP MACHINA5õ1660 MACHINA1 LDY #0õ1670     LDA NOPCJAõ1680     CMP #2õ1690     BNE MACHINA12õ1700     LDY ZN+3õ1710 MACHINA12 JSR GETJOYõ1720     STA POMõ1730     JSR CHKPIONõ1740     SEC õ1750     LDA #9õ1760     SBC YCELõ1770     JSR PLMACHPOSõ1780     LDA #2õ1790     JSR WAITõ1800     LDA IMMZNõ1810     BNE MACHINA10õ1820     LDA $D01Fõ1830     AND #$07õ1840     CMP #$03õ1850     BEQ MACHINA5õ1860 MACHINA10 LDY #0õ1870     LDA NOPCJAõ1880     CMP #2õ1890     BNE MACHINA13õ1900     LDY ZN+3õ1910 MACHINA13 JSR GETFIREõ1920     BNE MACHINA1õ1930     SEC õ1940     LDA #9õ1950     SBC YCELõ1960 MACHINA3 CMP #12õ1970     BEQ MACHINA4õ1980     PHA õ1990     JSR PLMACHPOSõ2000     LDA #2õ2010     JSR WAITõ2020     PLA õ2030     CLC õ2040     ADC #1õ2050     BNE MACHINA3õ2060 MACHINA4 LDA YCELõ2070     JSR LOTKULAõ2080     LDA YCELõ2090     CMP ZN+1õ2100     BNE MACHINA6õ2110     DEC ZN+1õ2120     INC ZN+2õ2130     LDA ZN+2õ2140     JSR PLMURFAZAõ2150 MACHINA6 LDA #30õ2160     JSR WAITõ2170     LDA #11õ2180 MACHINA7 PHA õ2190     JSR PLMACHPOSõ2200     LDA #3õ2210     JSR WAITõ2220     PLA õ2230     SEC õ2240     SBC #1õ2250     BPL MACHINA7õ2260     JMP MACHINA2õ2270 MACHINA5 ADC #0õ2280     STA VZNõ2290     BEQ MACHINA9õ2300     LDX ZN+3õ2310     INC NWINOBL,Xõ2320     BNE MACHINA9õ2330     LDA #255õ2340     STA NWINOBL,Xõ2350 MACHINA9 LDY #0õ2360     LDA NOPCJAõ2370     CMP #2õ2380     BNE MACHINA14õ2390     LDY ZN+3õ2400 MACHINA14 JSR WAITFIREõ2410     PLA õ2420     STA ZN+3õ2430     PLA õ2440     STA ZN+2õ2450     PLA õ2460     STA ZN+1õ2470     PLA õ2480     STA ZNõ2490     LDA VZNõ2500     RTS õ2510 ;õ2520 PLMACHPOS ASL Aõ2530     ASL Aõ2540     ASL Aõ2550     CLC õ2560     ADC # <KATANIMBUFõ2570     STA VZNõ2580     LDA # >KATANIMBUFõ2590     ADC #0õ2600     STA VZN+1õ2610     LDX #0õ2620     LDA #15õ2630     STA VZN+2õ2640 PLMACHPOS1 LDY #0õ2650 PLMACHPOS2 LDA (VZN),Yõ2660     STA ZAMEK1PIC+86*8,Xõ2670     STA ZAMEK2PIC+86*8,Xõ2680     INY õ2690     INX õ2700     CPY #8õ2710     BNE PLMACHPOS2õ2720     CLC õ2730     LDA VZNõ2740     ADC #96õ2750     STA VZNõ2760     BCC PLMACHPOS3õ2770     INC VZN+1õ2780 PLMACHPOS3 DEC VZN+2õ2790     BNE PLMACHPOS1õ2800     RTS õ2810 ;õ2820 LICZKULAPOS LDY XCELõ2830     LDA (VZN),Yõ2840     STA POMõ2850     LDA #168õ2860     SEC õ2870     SBC POMõ2880     TAY õ2890     JSR POSKULAõ2900     INC XCELõ2910     RTS õ2920 ;õ2930 POSKULA LDX #$00õ2940     TXA õ2950 POSKULA1 STA PMBASE+$0400,Xõ2960     STA PMBASE+$0500,Xõ2970     INX õ2980     BNE POSKULA1õ2990     JSR CHKPOZKULAõ3000     LDA #$10õ3010 POSKULA2 PHA õ3020     LDA KULASPRDATA,Xõ3030     STA PMBASE+$0400,Yõ3040     LDA KULASPRDATB,Xõ3050     STA PMBASE+$0500,Yõ3060     INX õ3070     INY õ3080     PLA õ3090     SEC õ3100     SBC #$01õ3110     BNE POSKULA2õ3120     RTS õ3130 ;õ3140 CHKPOZKULA LDA #$00õ3150     LDX XCELõ3160     CPX #36õ3170     BCC CHKPOZKULA1õ3180     ADC #$0Fõ3190     CPX #80õ3200     BCC CHKPOZKULA1õ3210     ADC #$0Fõ3220     CPX #92õ3230     BCC CHKPOZKULA1õ3240     ADC #$0Fõ3250 CHKPOZKULA1 TAX õ3260     RTS õ3270 ;õ3280 KULASPRDATA .BYTE $00,$00,$00,$00,$00,$00,$04,$0Eõ3290     .BYTE $0E,$0E,$1E,$1E,$1C,$1C,$18,$00õ3300 ;õ3310     .BYTE $00,$00,$00,$00,$00,$00,$04,$0Cõ3320     .BYTE $0C,$1C,$1C,$18,$00,$00,$00,$00õ3330 ;õ3340     .BYTE $00,$00,$00,$00,$00,$00,$00,$08õ3350     .BYTE $08,$18,$00,$00,$00,$00,$00,$00õ3360 ;õ3370     .BYTE $00,$00,$00,$00,$00,$00,$00,$00õ3380     .BYTE $10,$00,$00,$00,$00,$00,$00,$00õ3390 ;õ3400 KULASPRDATB .BYTE $00,$00,$00,$00,$18,$18,$38,$78õ3410     .BYTE $70,$70,$60,$60,$20,$20,$00,$00õ3420 ;õ3430     .BYTE $00,$00,$00,$00,$18,$3C,$38,$30õ3440     .BYTE $30,$20,$20,$00,$00,$00,$00,$00õ3450 ;õ3460     .BYTE $00,$00,$00,$00,$00,$00,$18,$10õ3470     .BYTE $10,$00,$00,$00,$00,$00,$00,$00õ3480 ;õ3490     .BYTE $00,$00,$00,$00,$00,$00,$00,$10õ3500     .BYTE $00,$00,$00,$00,$00,$00,$00,$00õ3510 ;õ3520 LOTKULA TAY õ3530     LDA # <LOTDATõ3540     LDX # >LOTDATõ3550 LOTKULA2 DEY õ3560     BMI LOTKULA3õ3570     CLC õ3580     ADC #$80õ3590     BCC LOTKULA2õ3600     INX õ3610     BNE LOTKULA2õ3620 LOTKULA3 STA VZNõ3630     STX VZN+1õ3640     LDA #$02õ3650     STA XCELõ3660     STA $D012õ3670     STA $D008õ3680     STA $D009õ3690     LDA #$04õ3700     STA $D013õ3710     LDA #138õ3720     STA $D000õ3730     STA $D001õ3740 LOTKULA1 JSR LICZKULAPOSõ3750     LDA #1õ3760     JSR WAITõ3770     LDA POMõ3780     BEQ LOTKULA4õ3790     LDA XCELõ3800     CMP #98õ3810     BCC LOTKULA1õ3820 LOTKULA4 LDA #0õ3830     STA $D000õ3840     STA $D001õ3850     RTS õ3860 ;õ3870 PLMURFAZA ASL Aõ3880     ASL Aõ3890     ASL Aõ3900     CLC õ3910     ADC # <MURANIMBUFõ3920     STA VZNõ3930     LDA # >MURANIMBUFõ3940     ADC #0õ3950     STA VZN+1õ3960     LDX #0õ3970     LDA #27õ3980     STA VZN+2õ3990 PLMURFAZA1 LDY #0õ4000 PLMURFAZA2 LDA (VZN),Yõ4010     STA ZAMEK1PIC+101*8,Xõ4020     STA ZAMEK2PIC+101*8,Xõ4030     INY õ4040     INX õ4050     CPY #8õ4060     BNE PLMURFAZA2õ4070     CLC õ4080     LDA VZNõ4090     ADC #96õ4100     STA VZNõ4110     BCC PLMURFAZA3õ4120     INC VZN+1õ4130 PLMURFAZA3 DEC VZN+2õ4140     BNE PLMURFAZA1õ4150     RTS õ4160 ;õ